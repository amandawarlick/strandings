---
title: ''
output:
  word_document:
    reference_docx: mytemplate.docx
  pdf_document: default
---

```{r include = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, results = 'asis', fig.width = 4, fig.height = 3.5)
```

```{r load packages, results = 'hide', message = FALSE}

library(devtools)
##devtools::install_github("hadley/ggplot2", force = TRUE)
# install_github("hadley/ggplot2@v2.2.0")
# devtools::install_github("dkahle/ggmap")
#devtools::install_github("adletaw/captioner")
library(tidyr)
library(ggmap)
library(maps)
library(mapdata)
library(lubridate) 
library(sciplot)
#library(rgdal) #??
#library(data.table)
library(dplyr)
library(cowplot)
library(ggplot2)
library(ggrepel)
library(stats)
library(captioner)
library(knitr)
library(reshape2)
library(stringr)
library(magrittr)
library(sciplot) #se()
library(scales)
library(stats) #kruskal.test
library(PMCMR) # posthoc.kruskal.nemenyi.test https://cran.r-project.org/web/packages/PMCMR/vignettes/PMCMR.pdf
library(strucchange) # chow test https://cran.r-project.org/web/packages/strucchange/strucchange.pdf  
library(pgirmess) #kruskalmc
#library(GGally)

case <- function(x)
  paste0(toupper(substr(x, 1, 1)), tolower(substring(x, 2)))

firstCap <- function(s, strict = FALSE) {
    cap <- function(s) paste(toupper(substring(s, 1, 1)),
                  {s <- substring(s, 2); if(strict) tolower(s) else s},
                             sep = "", collapse = " " )
    sapply(strsplit(s, split = " "), cap, USE.NAMES = !is.null(names(s)))
}

figs <- captioner(prefix = "Figure")
tbls <- captioner(prefix = "Table")

pubfigure_simple_theme <- function(...) {
  theme(text = element_text(family = 'Times'),
    #axis.text.x = element_blank(),
    #axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 10),
    axis.text.y = element_text(vjust = 0.5, color = "black", size = 10), 
    #axis.title.x = element_blank(),
    axis.line.y = element_line(colour = "black"), 
    axis.line.x = element_line(colour = "black"), 
    plot.background = element_rect(), 
    panel.background = element_blank(), 
    panel.grid = element_blank(),
    legend.title = element_blank(),
    legend.key = element_blank(),
    legend.text = element_text(size = 8),
    ...)
}

pubfigure_theme <- function(...) {
  theme(text = element_text(family = 'Times'),
    #text = element_text(size = 11),
    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 10),
    axis.text.y = element_text(vjust = 0.5, color = "black", size = 10), 
    axis.title = element_text(size = 10),
    axis.line.y = element_line(colour = "black"), 
    axis.line.x = element_line(colour = "black"), 
    plot.background = element_rect(), 
    panel.background = element_blank(), 
    panel.grid = element_blank(), 
    legend.title = element_blank(),
    legend.key = element_blank(),
    legend.text = element_text(size = 8),
    ...)
}

color6 <- c("#e45f56", "#363e7e", "#4aaaa5", "#a3d39c", "#f6b61c", "#3b98ee", "#999aa7")
color3 <- c("#e45f56", "#363e7e", "#a3d39c")
color4_HI <- c("#3b98ee", "#a3d39c", "#e45f56", "#f6b61c")
color4_age <- c("#ff8000", "#363e7e", "#3b98ee", "#a3d39c")
color2 <- c("#e45f56", "#363e7e")

red_blue <- c('#d73027','#f46d43','#fdae61','#fee090','#e0f3f8','#abd9e9','#74add1','#4575b4')
red_green <- c('#d53e4f','#f46d43','#fdae61','#fee08b','#e6f598','#abdda4','#66c2a5','#3288bd')
rainbow12 <- c('#3288bd', '#66c2a5', '#abdda4', '#e6f598', '#ffffbf', '#fee08b', '#fdae61', '#f46d43', '#d53e4f')


```

```{r load tables, echo = FALSE, results = 'hide'}
setwd("~/Documents/Research/strandings/Figures")

#Creating tables for inline references

#Age and sex per species
species_age_sex_composition_table <- read.csv("species_age_sex_composition.csv", check.names = F)
tbls("species_age_sex_composition_table", caption = "Age and sex composition and weighted averages of all strandings (n = 14,729) by species. Age class composition is derived from the subset of data from 2002-2016.")

#Sex and age disposition proportion table
age_sex_composition_table <- read.csv("age_sex_composition_table.csv", check.names = FALSE)
tbls("age_sex_composition_table", caption = "Age and sex composition of all strandings, human interaction (HI) cases, the prevalence of HI (HI cases/all strandings) and the composition of HI cases (HI type/total HI). Age class composition is derived from the subset of data from 2002-2016.")

#HI proportion of species
species_HI_prop_table <- read.csv("species_HI_prop_table.csv", check.names = F)
tbls("species_HI_prop_table", caption = "Number and composition of all strandings (n = 14,729), regional strandings, and human interaction (HI) cases (n = 1,703) identified to species, and the prevalence of HI (HI cases/all strandings) and the composition of HI cases (HI type/total HI).")

#Washington counties
WAcounties_table <- read.csv("WAcounties_table.csv", check.names = FALSE)
tbls("WAcounties_table", caption = "The number and proportion of all strandings and human interaction (HI) cases and the composition of HI cases for each county in Washington (n = 9,419).")

#Oregon counties
ORcounties_table <- read.csv("ORcounties_table.csv", check.names = FALSE)
tbls("ORcounties_table", caption = "The number and proportion of all strandings and human interaction (HI) cases and the composition of HI cases for each county in Oregon (*n* = 5,310).")

#Combined with other tables, now just for inline stats
age_sex_table <- read.csv("age_sex_table.csv", check.names = F)
age_sex_table$Age.Class <- as.character(age_sex_table$Age.Class)
age_sex_table[6, 1] <- "Average"
colnames(age_sex_table) <- c("Age Class", "Total (N)", "Female (N)", "Female (%)", "Male (N)", "Male (%)", "Unid. (N)", "Unid. (%)")

setwd("~/Documents/Research/strandings") 

center_locations <- read.csv("Center_Locations.csv", check.names = F)

```

```{r load pre-cleaned csv, echo = FALSE}

# pinnipeds_data <- read.csv("pinnipeds_data_protected.csv", header = TRUE, na.strings = "", stringsAsFactors = FALSE) 

pinnipeds_data <- read.csv("pinnipeds_data_protected.csv", header = TRUE, na.strings = "", stringsAsFactors = FALSE) %>%
  filter(Year.of.Observation > 1990)

pinnipeds_data <- pinnipeds_data %>%
  transform(Observation.Status.clean = toupper(pinnipeds_data$Observation.Status)) %>%
  transform(Observation.Status.clean = ifelse(Observation.Status.clean == 'NA' | Observation.Status.clean == 'CONDITION UNKNOWN' | Observation.Status.clean == 'UNKNOWN', 'UNKNOWN',
        ifelse(Observation.Status.clean == 'MUMMIFIED/SKELETAL', 'ADVANCED DECOMPOSITION',
               ifelse(Observation.Status.clean == 'DEAD - CONDITION UNKNOWN', 'MODERATE DECOMPOSITION', Observation.Status.clean))))

pinnipeds_data$Age.Class <- gsub("NA", "Unid", pinnipeds_data$Age.Class)
pinnipeds_data$Age.Class <- gsub("UNKNOWN", "Unid", pinnipeds_data$Age.Class)
pinnipeds_data$Age.Class <- gsub("PUP/CALF", "PUP", pinnipeds_data$Age.Class)
pinnipeds_data$Age.Class <- case(pinnipeds_data$Age.Class)
pinnipeds_data$Age.Class <- factor(pinnipeds_data$Age.Class, 
    levels = c("Pup", "Yearling", "Subadult", "Adult", "Unid"))
 
pinnipeds_data$Sex <- gsub("NA", "Unid", pinnipeds_data$Sex)
pinnipeds_data$Sex <- gsub("UNKNOWN", "Unid", pinnipeds_data$Sex)
pinnipeds_data$Sex <- case(pinnipeds_data$Sex)

pinnipeds_data$Month.of.Observation <- factor(pinnipeds_data$Month.of.Observation, levels = c('JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN', 'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'))

pinnipeds_data$County <- factor(pinnipeds_data$County, levels = c('Whatcom', 'San Juan', 'Island', 'Skagit', 'Snohomish', 'King', 'Kitsap', 'Pierce', 'Thurston', 'Mason', 'Clallam', 'Jefferson', 'Grays Harbor', 'Pacific', 'Cowlitz', 'Clark', 'Clatsop', 'Columbia', 'Multnomah', 'Tillamook', 'Lincoln', 'Lane', 'Douglas', 'Coos', 'Curry'))

#Data objects for inline stats
species <- pinnipeds_data %>%
  group_by(Pinniped.Common.Name) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number))

species_year_mean <- pinnipeds_data %>%
  group_by(Year.of.Observation, Pinniped.Common.Name) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  group_by(Pinniped.Common.Name) %>%
  dplyr::summarize(mean = round(mean(cnt)), median = round(median(cnt)))

species_HI <- pinnipeds_data %>%
  #filter(Pinniped.Common.Name != 'Unidentified') %>%
  filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>%
  group_by(Pinniped.Common.Name) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  transform(prop = round(cnt/sum(cnt), 2)*100)
sum(species_HI$cnt)

age_all <- pinnipeds_data %>%
  group_by(Age.Class) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) 
  age_all$prop <- round(age_all$cnt/sum(age_all$cnt), 2)*100

data_by_year <- pinnipeds_data %>% 
  group_by(Year.of.Observation) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number))

data_by_year_state_prop <- pinnipeds_data %>%
  filter(!is.na(Water.Body) & Water.Body != 'NA') %>% #fix NAs
  group_by(Water.Body, Year.of.Observation) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  dcast(Year.of.Observation ~ Water.Body, value.var = 'cnt') %>%
  transform(prop.or = round(OR_Coast/(OR_Coast + WA_Coast + Inland_WA), 2)*100,
            prop.wa_in = round(Inland_WA/(OR_Coast + WA_Coast + Inland_WA), 2)*100,
            prop.wa_coast = round(WA_Coast/(OR_Coast + WA_Coast + Inland_WA), 2)*100)

HI_state_prop_sb <- pinnipeds_data %>%
  filter(!is.na(Water.Body) & Water.Body != 'NA') %>% 
  filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>%
  group_by(Water.Body, Interaction.Type) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  dcast(Interaction.Type ~ Water.Body, value.var = 'cnt') 

HI_state_prop <- pinnipeds_data %>%
  filter(!is.na(Water.Body) & Water.Body != 'NA') %>% 
  filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>%
  group_by(Water.Body, Interaction.Type) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  dcast(Interaction.Type ~ Water.Body, value.var = 'cnt') %>%
  transform(prop.or = round(OR_Coast/(OR_Coast + WA_Coast + Inland_WA), 2)*100,
            prop.wa_in = round(Inland_WA/(OR_Coast + WA_Coast + Inland_WA), 2)*100,
            prop.wa_coast = round(WA_Coast/(OR_Coast + WA_Coast + Inland_WA), 2)*100)

year_prop_HI <- pinnipeds_data %>%
  group_by(Findings.of.Human.Interaction, Year.of.Observation) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  dcast(Year.of.Observation ~ Findings.of.Human.Interaction, value.var = 'cnt') 
year_prop_HI[is.na(year_prop_HI)] <- 0
year_prop_HI <- year_prop_HI %>% transform(Prop.HI = round(Y/(Y + N + CBD), 2)*100)

oregon <- pinnipeds_data %>%
#   #filter(Water.Body != 'OR_Coast') %>%
   #filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>%
#   #filter(Pinniped.Common.Name != 'Unidentified') %>%
  filter(Year.of.Observation > 2001) %>%
#   filter(Water.Body == 'Inland_WA') %>%
   nrow()

```

```{r all figures, echo = FALSE, results = 'hide'}

#Figures

#Species boxplots
species_all_final <- pinnipeds_data %>%
  filter(Pinniped.Common.Name != 'Unidentified') %>%
  group_by(Year.of.Observation, Short_name) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  ggplot(aes(Short_name, cnt)) +
  geom_boxplot() +
  scale_y_continuous(labels = comma) +
  xlab("") + ylab("Annual Strandings") +
  pubfigure_simple_theme(axis.text.x = element_blank(),
                  axis.title.y = element_text(size = 10))
  
species_HI_type_final <- pinnipeds_data %>%
  filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>%
  filter(Pinniped.Common.Name != 'Unidentified') %>%
  group_by(Year.of.Observation, Pinniped.Common.Name, Interaction.Type) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  ggplot(aes(Pinniped.Common.Name, cnt, fill = Interaction.Type)) +
  geom_boxplot() +
  xlab("") + ylab("Annual Human Interactions") +
  scale_y_continuous(labels = comma) +
  pubfigure_theme(legend.position = c(.05, .9)) + 
 scale_fill_manual(values = color4_HI, guide = guide_legend(nrow = 1))

species_boxplots <- plot_grid(species_all_final, species_HI_type_final, labels = "auto", align = 'v', ncol = 1, rel_heights = c(1, 1.6), hjust = 0, label_size = 10)
figs("species_boxplots", caption = "Boxplots of (a) annual stranding cases for each species, and (b) annual human interactions by case type.")

#ggsave(filename = "species_boxplots.tiff", width = 9, height = 11, units = "in", dpi = 300)
ggsave(filename = "species_boxplots.pdf", width = 9, height = 11, units = "in", dpi = 300)

################

#annual time series by species
all_yr_data <- pinnipeds_data %>% 
  filter(Pinniped.Common.Name != 'Unidentified') %>%
  group_by(Year.of.Observation, Pinniped.Common.Name) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) 

all_yr_final <- ggplot(data = all_yr_data, aes(x = Year.of.Observation, y = cnt)) + 
  geom_line(aes(group = Pinniped.Common.Name, col = Pinniped.Common.Name), size = 1) +
  geom_smooth(data = all_yr_data %>% group_by(Year.of.Observation) %>% dplyr::summarize(cnt = sum(cnt)), aes(x = Year.of.Observation, y = cnt), method = "loess", se = FALSE, col = 'black', size = 0.8, linetype = 3) +
  xlab("") + ylab("Annual Strandings") +
  scale_y_continuous(labels = comma) +
  scale_x_continuous(breaks = c(1990, 1995, 2000, 2005, 2010, 2015)) +
  pubfigure_theme(
    # axis.title = element_text(size = 10),
    # axis.text.x = element_blank(),
    legend.position = c(.04,.9)) +
  scale_color_manual(values = color6, guide = guide_legend(nrow = 2))
ggsave(filename = "all_yr_final.pdf", width = 7, height = 4, units = "in", dpi = 300)

#Annual timeseries by region
# statelineplotdata <- pinnipeds_data %>%
#   filter(!is.na(Water.Body) & Water.Body != 'NA') %>% 
#   group_by(Water.Body, Year.of.Observation) %>%
#   dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
#   transform(Water.Body = gsub("_", " ", Water.Body)) 

figs("all_yr_final", caption = "(a) Increasing total reported strandings across all species (*n* = 14,939) (black dotted loess regression line) and increasing for harbor seals (y = 1.057^x^, z = 6.2, *p* < 0.001), California sea lions (y = 1.098^x^, z = 7.7, *p* < 0.001), Steller sea lions (y = 1.143^x^, z = 8.3, *p* < 0.001), Guadalupe fur seals (y = 1.159^x^, z = 2.0, *p* < 0.05), and northern fur seals (y = 1.044^x^, z = 2.2, *p* < 0.05).")

#all and HI by species time series

HI_data_sp <- pinnipeds_data %>%
  filter(Findings.of.Human.Interaction == 'Y' & Pinniped.Common.Name != 'Unidentified') %>%
  group_by(Year.of.Observation, Pinniped.Common.Name) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) 

HI_species_final <- ggplot(data = HI_data_sp, aes(x = Year.of.Observation, y = cnt)) +
  geom_line(aes(group = Pinniped.Common.Name, col = Pinniped.Common.Name), size = 1) + 
  geom_smooth(data = HI_data_sp %>% group_by(Year.of.Observation) %>% dplyr::summarize(cnt = sum(cnt)), aes(x = Year.of.Observation, y = cnt), 
              method = 'loess', se = F, col = "black", linetype = 3) +
  ylab("Human Interaction Cases") + xlab("") + 
  scale_y_continuous(labels = comma) + 
  scale_x_continuous(breaks = c(1990, 1995, 2000, 2005, 2010, 2015)) +
  pubfigure_simple_theme(legend.position = c(.04,.9),
                         axis.title = element_text(size = 10),
                         axis.text.x = element_blank()) +
  scale_color_manual(values = color6, guide = guide_legend(nrow = 2))

HI_type_data <- pinnipeds_data %>%
  filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>%
  group_by(Year.of.Observation, Interaction.Type) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) 

HI_type_final <- ggplot(data = HI_type_data, aes(x = Year.of.Observation, y = cnt)) +
  geom_line(aes(group = Interaction.Type, col = Interaction.Type), size = 1) + 
  geom_smooth(data = HI_type_data %>% group_by(Year.of.Observation) %>% dplyr::summarize(cnt = sum(cnt)), method = 'loess', se = F, col = "black", linetype = 3) +
  ylab("Human Interaction Cases") + xlab("") + 
  scale_y_continuous(labels = comma) +
  pubfigure_theme(legend.position = c(.1,.9)) + 
  scale_x_continuous(breaks = c(1990, 1995, 2000, 2005, 2010, 2015)) +
  scale_color_manual(values = color4_HI, guide = guide_legend(nrow = 1))

HI_timeseries <- plot_grid(HI_species_final, HI_type_final, align = 'v', ncol = 1, labels = "auto", vjust = c(1.2, .1), label_size = 10)
figs("HI_timeseries", caption = "(a) Annual HI cases combined (black loess regression line) and for each species illustrate increasing cases for harbor seals (y = 1.114^x^, z = 8.7, *p* < 0.001), California sea lions (y = 1.099^x^, z = 6.3, *p* < 0.001), Steller sea lions (y = 1.095^x^, z = 5.3, *p* < 0.001), and Guadalupe fur seals (y = 1.173^x^, z = 2.1, *p* < 0.05)  and (b) increasing number of gunshot wounds (y = 1.073^x^, z = 4.6, *p* < 0.001), fisheries entanglements (y = 1.090^x^, z = 8.3, *p* < 0.001), and boat injuries (y = 1.087^x^, z = 3.3, *p* < 0.01).")
ggsave(filename = "HI_species_final.pdf", width = 8.5, height = 11, units = "in", dpi = 300)


numberperyear <- pinnipeds_data %>%
  group_by(Year.of.Observation) %>%
  dplyr::summarize(yr.cnt = n_distinct(National.Database.Number))

#HI over time - by species
allprev_sp <- pinnipeds_data %>%
  filter(Pinniped.Common.Name != 'Unidentified') %>%
  group_by(Findings.of.Human.Interaction, Year.of.Observation, Pinniped.Common.Name) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  dcast(Year.of.Observation + Pinniped.Common.Name ~ Findings.of.Human.Interaction, value.var = 'cnt') 
allprev_sp[is.na(allprev_sp)] <- 0
allprev_sp <- allprev_sp %>% transform(HI.Prev = Y/(Y+N+CBD)) %>%
  dplyr::select(Year.of.Observation, Pinniped.Common.Name, HI.Prev) %>%
  transform(period = ifelse(Year.of.Observation < 2000, '1991-1999', 
                            ifelse(Year.of.Observation < 2010 & Year.of.Observation > 1999, '2000-2009', '2010-2016'))) 

HI_prev_sp_figure <- ggplot(allprev_sp, 
                            aes(x = Pinniped.Common.Name, y = HI.Prev, fill = period)) +
  geom_boxplot() +
  xlab("") + ylab("HI Proportion") +
  theme(text = element_text(family = 'Times'),
    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 10),
    axis.text.y = element_text(vjust = 0.5, color = "black", size = 10), 
    axis.title = element_text(size = 10),
    axis.line.y = element_line(colour = "black"), 
    axis.line.x = element_line(colour = "black"), 
    plot.background = element_rect(), 
    panel.background = element_blank(), 
    panel.grid = element_blank(), 
    legend.title = element_blank(),
    legend.key = element_blank(),
    legend.text = element_text(size = 10),
    legend.position = c(.05, .9)) + 
 scale_fill_manual(values = c("grey45", "grey75", "white"), guide = guide_legend(nrow = 1))

#HI prevalence by HI type
allprev_type <- pinnipeds_data %>%
  filter(Interaction.Type != 'NA') %>%
  group_by(Interaction.Type, Year.of.Observation) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  dcast(Year.of.Observation ~ Interaction.Type, value.var = 'cnt') 
allprev_type[is.na(allprev_type)] <- 0
allprev_type <- allprev_type %>%
  merge(numberperyear, by = 'Year.of.Observation') %>%
  transform(Boat = (Boat/yr.cnt), 
            Fisheries = (Fisheries/yr.cnt),
            Gunshot = (Gunshot/yr.cnt),
            Other = (Other/yr.cnt)) %>%
  dplyr::select(Year.of.Observation, Boat, Gunshot, Fisheries, Other) %>%
  melt(id.vars = "Year.of.Observation") %>%
  transform(period = ifelse(Year.of.Observation < 2000, '1991-1999', 
                            ifelse(Year.of.Observation < 2010 & Year.of.Observation > 1999, '2000-2009', '2010-2016')))

HI_type_prev_figure <- 
  ggplot(allprev_type, aes(x = variable, y = value, fill = period)) +
  geom_boxplot(varwidth = T) +
  #stat_summary(fun.y = mean, color = "red", geom = "point") +
  xlab("") + ylab("HI Type Proportion") +
  theme(text = element_text(family = 'Times'),
    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 10),
    axis.text.y = element_text(vjust = 0.5, color = "black", size = 10), 
    axis.title = element_text(size = 10),
    axis.line.y = element_line(colour = "black"), 
    axis.line.x = element_line(colour = "black"), 
    plot.background = element_rect(), 
    panel.background = element_blank(), 
    panel.grid = element_blank(), 
    legend.title = element_blank(),
    legend.key = element_blank(),
    legend.text = element_text(size = 10),
    legend.position = 'none') + 
 scale_fill_manual(values = c("grey45", "grey75", "white"), guide = F)

HI_prev_final <- plot_grid(HI_prev_sp_figure, HI_type_prev_figure, align = 'v', ncol = 1, labels = "auto", vjust = c(1.2, .1), rel_heights = c(1.5, 1), label_size = 10)
ggsave(filename = "HI_prev_final.pdf", width = 8.5, height = 11, units = "in", dpi = 300)

figs("HI_prev_final", caption = "Prevalence of human interaction cases (a) significantly increasing for all combined species (black dotted regression line, y = 0.06x, z = 15.5, *p* < 0.001) and for harbor seals (y = 0.06x, z = 11.4, *p* < 0.001), California sea lions (y = 0.03x, z = 3.8, *p* < 0.001), and northern elephant seals (y = 0.09x, z = 3.5, *p* < 0.001); (b) increasing for all HI types combined (black dotted regression line, y = 0.06x, z = 15.5, *p* < 0.001) and for each HI case type: gunshot wounds (y = 0.039x, z = 6.4, *p* < 0.001), fisheries entanglements (y = 0.043x, z = 5.3, *p* < 0.001), and boat injuries (y = 0.087x, z = 4.2, *p* < 0.001).")

####################

monthly_HI <- pinnipeds_data %>%
  filter(Findings.of.Human.Interaction == 'Y') %>%
  group_by(Month.of.Observation, Year.of.Observation, Interaction.Type, Sex, Age.Class, Pinniped.Common.Name) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) 

#Species
monthly_sp_data <- pinnipeds_data %>% 
  #filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>%
  filter(Pinniped.Common.Name != 'Unidentified') %>%
  group_by(Month.of.Observation, Pinniped.Common.Name, Year.of.Observation) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  group_by(Pinniped.Common.Name, Month.of.Observation) %>%
  dplyr::summarize(mean = mean(cnt, na.rm = T), se = se(cnt, na.rm = T)) 

monthly_sp_final_line <- ggplot(monthly_sp_data, 
                aes(x = factor(Month.of.Observation), y = mean, 
                    col = Pinniped.Common.Name, group = Pinniped.Common.Name, fill = Pinniped.Common.Name)) +
  geom_line() + geom_point(size = 1) +
  #geom_errorbar(aes(ymin = mean - se, ymax = mean + se, col = Pinniped.Common.Name), width = .1) +
  geom_ribbon(aes(ymin = mean - se, ymax = mean + se), alpha = 0.4, linetype = 'blank') +
  ylab("Mean Monthly Strandings") + xlab("") + 
  pubfigure_simple_theme(legend.position = c(.1, .85),
                         legend.key.size = unit(1.3, 'lines'),
        axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
        axis.title = element_text(size = 10)) + 
  scale_color_manual(values = color6, guide = guide_legend(nrow = 3)) +
  scale_fill_manual(values = color6, guide = guide_legend(nrow = 3))

#Age
monthly_age_data <- pinnipeds_data %>% 
  #filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>%
  filter(Age.Class != 'Unid') %>%
  group_by(Month.of.Observation, Age.Class, Year.of.Observation) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  group_by(Age.Class, Month.of.Observation) %>%
  dplyr::summarize(mean = mean(cnt, na.rm = T), se = se(cnt, na.rm = T)) 

monthly_age_final_line <- ggplot(monthly_age_data, 
                aes(x = factor(Month.of.Observation), y = mean, 
                    col = Age.Class, group = Age.Class, fill = Age.Class)) +
  geom_line() + geom_point(size = 1) +
  #geom_errorbar(aes(ymin = mean - se, ymax = mean + se, col = Age.Class), width = .1) +
  geom_ribbon(aes(ymin = mean - se, ymax = mean + se), alpha = 0.4, linetype = 'blank') +
  ylab("Mean Monthly Strandings") + xlab("") + 
  pubfigure_simple_theme(legend.position = c(.1, .93),
                         legend.key.size = unit(1.3, 'lines'),
        axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
        axis.title = element_text(size = 10)) + 
  scale_color_manual(values = color4_age, guide = guide_legend(nrow = 1)) +
  scale_fill_manual(values = color4_age, guide = guide_legend(nrow = 1))

#HI type
monthly_HI_data <- pinnipeds_data %>% 
  filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>%
  group_by(Month.of.Observation, Interaction.Type, Year.of.Observation) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  group_by(Interaction.Type, Month.of.Observation) %>%
  dplyr::summarize(mean = mean(cnt, na.rm = T), se = se(cnt, na.rm = T)) 

monthly_HI_final_line <- ggplot(monthly_HI_data, 
                aes(x = factor(Month.of.Observation), y = mean, 
                    col = Interaction.Type, group = Interaction.Type, fill = Interaction.Type)) +
  geom_line() + geom_point(size = 1) +
  #geom_errorbar(aes(ymin = mean - se, ymax = mean + se, col = Interaction.Type), width = .1) +
  geom_ribbon(aes(ymin = mean - se, ymax = mean + se), alpha = 0.4, linetype = 'blank') +
  ylab("Mean Monthly HI Cases") + xlab("") + 
  pubfigure_simple_theme(
    legend.position = c(.1, .93),
    legend.key.size = unit(1.3, 'lines'),
    axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
    axis.title = element_text(size = 10)) + 
  scale_y_continuous(breaks = seq(0, 10, 2)) +
  scale_color_manual(values = color4_HI, guide = guide_legend(nrow = 1)) +
  scale_fill_manual(values = color4_HI, guide = guide_legend(nrow = 1))

monthly_combined_line <- plot_grid(monthly_sp_final_line, monthly_HI_final_line, align = 'v', ncol = 1, label_size = 10, labels = "auto")

figs("monthly_combined_line", caption = "Mean number of strandings and human interaction cases and confidence interval bands (+/- 1 SE of mean) for each month according to (a) species and (b) human interaction type.")

ggsave(filename = "monthly_combined_line.pdf", width = 8.5, height = 11, units = "in", dpi = 300)

##############

##all and HI cases by county
all_county_final <- pinnipeds_data %>% 
  filter(County != 'NA' & County != 'Unknown' & Pinniped.Common.Name != 'Unidentified') %>% 
  group_by(County, Pinniped.Common.Name) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  ggplot(aes(x = County, y = cnt, fill = Pinniped.Common.Name)) + 
  geom_bar(stat = 'identity', width = 0.6)  + 
  geom_vline(xintercept = 16.5, linetype = "dashed") +
  annotate("text", x = 2, y = 2000, label = "*") +  annotate("text", x = 3, y = 900, label = "*") +
  annotate("text", x = 8, y = 1240, label = "*") +  annotate("text", x = 17, y = 850, label = "*") +
  annotate("text", x = 21, y = 1800, label = "*") +  
  ylab("All Strandings") +
  scale_y_continuous(labels = comma) +
  pubfigure_theme(legend.position = c(.35, .9),
                  axis.title.x = element_blank(),
            plot.margin = unit(c(.1, .1, .1, .1), "cm")) +
  scale_fill_manual(values = color6, guide = guide_legend(nrow = 3))

HI_county_final <- pinnipeds_data %>% 
  filter(County != 'NA' & County != 'Unknown' &
        Findings.of.Human.Interaction == 'Y' & 
        Interaction.Type != 'NA') %>% 
  group_by(County, Interaction.Type) %>%
  dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
  ggplot(aes(x = County, y = cnt, fill = Interaction.Type)) + 
  geom_bar(stat = 'identity', width = 0.6)  + 
  geom_vline(xintercept = 16.5, linetype = "dashed") +
  annotate("text", x = 1, y = 110, label = "*") +  annotate("text", x = 8, y = 175, label = "*") +
  annotate("text", x = 13, y = 120, label = "*") + annotate("text", x = 14, y = 160, label = "*") +
  annotate("text", x = 17, y = 267, label = "*") +  annotate("text", x = 21, y = 155, label = "*") +
  #annotate("text", x = c(8, 20), y = -120, label = c("Washington", "Oregon")) +
  ylab("Human Interactions") + 
  scale_y_continuous(labels = comma) +
  pubfigure_theme(legend.position = c(.3, .9),
                  axis.title.x = element_blank(),
                  plot.margin = unit(c(.1, .1, .1, .1), "cm")) + 
  scale_fill_manual(values = color4_HI, guide = guide_legend(nrow = 1))


```

```{r density plots}

monthly_all_dens_date <- pinnipeds_data %>%
  transform(Month = as.integer(Month.of.Observation)) %>%
  transform(Date = as.Date(paste(Year.of.Observation, Month, Day.of.Observation, sep = "-"), format = '%Y-%m-%d')) %>%
  transform(yday = yday(Date))

#Species
monthly_all_sp_dens <-
  ggplot(data = monthly_all_dens_date %>% filter(Pinniped.Common.Name != 'Unidentified'), aes(yday, col = Pinniped.Common.Name)) +
  geom_line(data = monthly_all_dens_date  %>% filter(Pinniped.Common.Name != 'Unidentified' & Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'), stat = 'density', aes(yday, col = Pinniped.Common.Name), linetype = 'dashed') +
  geom_line(data = monthly_all_dens_date %>% filter(Pinniped.Common.Name != 'Unidentified'), stat = 'density') +
  geom_rug(sides = "b", aes(y = 0), position = 'jitter', alpha = 0.35) +
  ylab("Relative Frequency Density") + xlab("") +
  pubfigure_simple_theme(legend.position = c(.22, .9),
        axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
        axis.title = element_text(size = 10)) +
  scale_color_manual(values = color6, guide = guide_legend(nrow = 3)) +
  scale_y_continuous(limit = c(0, 0.022)) +
  scale_x_continuous(limit = c(0, 365), breaks = c(0, 30, 60, 90, 120, 150, 180, 210,
                                                   240, 270, 300, 330),
                     labels = c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
                                'Sep', 'Oct', 'Nov', 'Dec'))

#Age all
monthly_all_age_dens <-
  ggplot(data = monthly_all_dens_date %>% filter(Age.Class != 'Unid'), aes(yday, col = Age.Class)) +
  geom_line(data = monthly_all_dens_date  %>% filter(Age.Class != 'Unid' & Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'), stat = 'density', aes(yday, col = Age.Class), linetype = 'dashed') +
  geom_line(data = monthly_all_dens_date %>% filter(Age.Class != 'Unid'), stat = 'density') +
  geom_rug(sides = "b", aes(y = 0), position = 'jitter', alpha = 0.35) +
  ylab("Relative Frequency Density") + xlab("") +
  pubfigure_simple_theme(legend.position = c(.23, .93),
        axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
        axis.title = element_text(size = 10)) +
  scale_color_manual(values = color4_age, guide = guide_legend(nrow = 1)) +
  scale_y_continuous(limit = c(0, 0.01)) +
  scale_x_continuous(limit = c(0, 365), breaks = c(0, 30, 60, 90, 120, 150, 180, 210,
                                                   240, 270, 300, 330),
                     labels = c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
                                'Sep', 'Oct', 'Nov', 'Dec'))

#HI type
monthly_HI_type_dens <-
  ggplot(monthly_all_dens_date %>% filter(Interaction.Type != 'NA'
                                           & Findings.of.Human.Interaction == 'Y'), aes(yday, col = Interaction.Type)) +
  #geom_density(col = NA, alpha = .35) +
  geom_line(stat = 'density') +
  #stat_density(geom = "line", position = "identity") +
  geom_rug(sides = "b", aes(y = 0), position = 'jitter', alpha = 0.35) +
  ylab("Relative Frequency Density") + xlab("") +
  pubfigure_simple_theme(legend.position = c(.23, .93),
        axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
        axis.title = element_text(size = 10)) +
  scale_color_manual(values = color4_HI, guide = guide_legend(nrow = 1)) +
  scale_y_continuous(limit = c(0, 0.008)) +
  scale_x_continuous(limit = c(0, 365), breaks = c(0, 30, 60, 90, 120, 150, 180, 210,
                                                   240, 270, 300, 330),
                     labels = c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
                                'Sep', 'Oct', 'Nov', 'Dec'))

#All sex
monthly_all_sex_dens <-
  ggplot(data = monthly_all_dens_date %>% filter(Sex != 'Unid'), aes(yday, col = Sex)) +
  geom_line(data = monthly_all_dens_date  %>% filter(Sex != 'Unid' & Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'), stat = 'density', aes(yday, col = Sex), linetype = 'dashed') +
  geom_line(data = monthly_all_dens_date %>% filter(Sex != 'Unid'), stat = 'density') +
  geom_rug(sides = "b", aes(y = 0), position = 'jitter', alpha = 0.35) +
  #ylab("Density of Seasonal HI Cases") + xlab("") +
  ylab("Relative Frequency Density") + xlab("") +
  pubfigure_simple_theme(legend.position = c(.2, .9),
        axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
        axis.title = element_text(size = 10)) +
  scale_color_manual(values = color2, guide = guide_legend(nrow = 1)) +
  scale_y_continuous(limit = c(0, 0.008)) +
  scale_x_continuous(limit = c(0, 365), breaks = c(0, 30, 60, 90, 120, 150, 180, 210,
                                                   240, 270, 300, 330),
                     labels = c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
                                'Sep', 'Oct', 'Nov', 'Dec'))

monthly_all_density <- plot_grid(monthly_all_sp_dens, monthly_all_age_dens, monthly_all_sex_dens, align = 'v', ncol = 1, label_size = 10, labels = "auto")


```

```{r maps, results = 'hide'}

latlong.cleaning <- pinnipeds_data %>%
  transform(Longitude = as.numeric(Longitude),
            Latitude = as.numeric(Latitude)) %>%
  #filter(Latitude > 47) %>%
  filter(Longitude > -124.00002) %>%
  filter(Longitude < -123.999) %>%
  dplyr::select(National.Database.Number, Year.of.Observation, State, City, County, lat_corr, long_corr)

#########MAPS#######
allbox <- c(-129, 41, -117, 50)
ORbox <- c(-125, 41.91, -121.5, 46.28)
WAbox <- c(-125.2, 46, -121.7, 49.1)
pugetbox <- c(-123.4, 46.96, -121.7, 48.86)

pinnipeds_data_mapping <- pinnipeds_data %>% 
  transform(Longitude = as.numeric(Longitude),
            Latitude = as.numeric(Latitude),
            long_corr = as.numeric(long_corr),
            lat_corr = as.numeric(lat_corr)) %>%
  transform(Season = 
              factor(ifelse(Month.of.Observation == 'DEC' | Month.of.Observation == 'JAN' |Month.of.Observation == 'FEB', 'Winter', 
                ifelse(Month.of.Observation == 'MAR' | Month.of.Observation == 'APR' |Month.of.Observation == 'MAY', 'Spring',
                       ifelse(Month.of.Observation == 'JUN' |Month.of.Observation == 'JUL' |Month.of.Observation == 'AUG', 'Summer', 'Fall'))), levels = c("Spring", "Summer", "Fall", "Winter"))) 

pinnipeds_data_mapping_sp <- pinnipeds_data_mapping %>% filter(Pinniped.Common.Name != 'Unidentified') 
#%>%
  #merge(weight_sp, by = 'Pinniped.Common.Name')

pinnipeds_data_mapping_HI <- pinnipeds_data_mapping %>% 
  filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA')

#state outline
canada <- map_data("world", region = "Canada") %>%
  filter(lat > 41.6 & lat < 52) %>%
  filter(long > -131 & long < -112) 

pnw_state_outline <- map_data("state", region = c("oregon", "washington")) %>%
  bind_rows(canada) 

HI_type_facet <- ggplot(pnw_state_outline) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "grey93", color = "grey50", size = 0.2) +
  coord_fixed(1, ylim = c(42.3, 49.15), xlim = c(-125, -121.8)) + 
  # geom_point(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr), color = 'grey20', size = 0.2, alpha = 0.8)  +
  geom_density2d(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr), bins = 4, col = 'red') +
  scale_alpha(range = c(0, 0.1), guide = FALSE) +
  xlab("") + ylab("") +
  facet_wrap(~ Interaction.Type) +
  #theme_nothing() +
  theme_classic() +
  theme(plot.margin = unit(c(0, -10, 0, -10), "mm"),
    axis.line = element_blank(),
    strip.text = element_text(size = 10),
    strip.background = element_blank(),
    panel.border = element_rect(colour = "black", fill = NA, size = 1))
figs("HI_type_facet", caption = "Kernel density contour lines showing hotspots of HI cases by type, with fisheries, boat collisions, and other distributed throughout inland Washington waters and at the mouth of the Columbia River, and gunshot wounds centered at the mouth of the Columbia River. Kernel density estimation is calculated for each case type separately, so contour lines are intended to show the spatial density of each type relative to itself, not compared to other case types.")
ggsave(filename = "HI_type_facet.pdf", width = 7, height = 11, units = "in", dpi = 300)

HIstrands_species <- ggplot(pnw_state_outline) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "grey93", color = "grey50", size = 0.2) +
  coord_fixed(1, ylim = c(42.3, 49.15), xlim = c(-125, -121.8)) + 
  # geom_point(data = pinnipeds_data_mapping_sp %>% filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'),
  #            aes(x = long_corr, y = lat_corr), col = 'grey40', size = 0.05, alpha = 1)  +
  geom_density2d(data = pinnipeds_data_mapping_sp %>% filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'), aes(x = long_corr, y = lat_corr), bins = 3, col = 'red') +
  geom_density2d(data = pinnipeds_data_mapping_sp, aes(x = long_corr, y = lat_corr), bins = 3, col = 'black') +  scale_alpha(range = c(0, 0.1), guide = FALSE) +
  xlab("") + ylab("") +
  facet_wrap(~ Pinniped.Common.Name) +
  theme_classic() +
   theme(plot.margin = unit(c(0, -5, 0, -5), "mm"),
    axis.line = element_blank(),
    strip.text = element_text(size = 9),
    strip.background = element_blank(),
    panel.border = element_rect(colour = "black", fill = NA, size = 1))
figs("HIstrands_species", caption = "Kernel density contour lines showing overlapping hotspots for all strandings (black) and human interaction cases (red) for all species, with hotspots occurring throughout inland Washington waters for harbor seals and along the outer coast near the mouth of the Columbia River for the other species. Kernel density estimation is calculated for each species separately, so contour lines are intended to show the spatial density of each species relative to itself, not compared to others.")
ggsave(filename = "HIstrands_species.pdf", width = 9, height = 11, units = "in", dpi = 300)
ggsave(filename = "HIstrands_species.tiff", width = 9, height = 11, units = "in", dpi = 300)
ggsave(filename = "HIstrands_species.jpeg", width = 9, height = 11, units = "in", dpi = 300)
```

```{r}

county_outline <- map_data("county", region = c("oregon", "washington")) %>%
  transform(subregion = firstCap(subregion))

countyHI_percs <- pinnipeds_data %>%
  filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>%
  group_by(Interaction.Type, County) %>%
  summarize(cnt = n_distinct(National.Database.Number)) %>%
  dcast(County ~ Interaction.Type, value.var = 'cnt') %>%
  transform(perc_fish = (Fisheries)/sum(Fisheries, na.rm = T)*100,
            perc_gun = (Gunshot)/sum(Gunshot, na.rm = T)*100) %>%
  dplyr::rename(subregion = County)

countymapdata <- bind_rows(WAcounties_table, ORcounties_table) %>%
  dplyr::rename(subregion = County) %>%
  merge(county_outline, by = 'subregion', all = T) %>%
  transform(subregion = as.character(subregion))
countymapdata <- countymapdata[order(countymapdata$order),]
colnames(countymapdata) <- c("subregion", "all_cnt", "all_perc", "HI_cnt", "HI_perc", "Fisheries", "Gun", "Boat", "Other", "long", "lat", "group", "order", "region")

countymapdata <- countymapdata %>%
  dplyr::select(-c(Fisheries, Gun, Boat, Other))


countymapdata <- countymapdata %>%
  transform(all_cnt = as.numeric(ifelse(region == 'washington' & subregion == 'Lincoln' | region == 'washington' & subregion == 'Columbia' | region == 'washington' & subregion == 'Douglas', 'NA', all_cnt))) %>%
  transform(HI_cnt = as.numeric(ifelse(region == 'washington' & subregion == 'Lincoln' | region == 'washington' & subregion == 'Columbia' | region == 'washington' & subregion == 'Douglas', 'NA', HI_cnt))) %>%
  transform(all_perc = as.numeric(ifelse(region == 'washington' & subregion == 'Lincoln' | region == 'washington' & subregion == 'Columbia' | region == 'washington' & subregion == 'Douglas', 'NA', all_perc))) %>%
  transform(HI_perc = as.numeric(ifelse(region == 'washington' & subregion == 'Lincoln' | region == 'washington' & subregion == 'Columbia' | region == 'washington' & subregion == 'Douglas', 'NA', HI_perc))) %>%
  transform(all_cnt = as.numeric(ifelse(region == 'oregon' & subregion == 'Jefferson', 'NA', all_cnt))) %>%
  transform(HI_cnt = as.numeric(ifelse(region == 'oregon' & subregion == 'Jefferson', 'NA', HI_cnt))) %>%
  transform(all_perc = as.numeric(ifelse(region == 'oregon' & subregion == 'Jefferson', 'NA', all_perc))) %>%
  transform(HI_perc = as.numeric(ifelse(region == 'oregon' & subregion == 'Jefferson', 'NA', HI_perc))) %>%
  merge(countyHI_percs, by = 'subregion', sort = FALSE)
countymapdata <- countymapdata[order(countymapdata$order),]

countymapdata <- countymapdata %>%
  transform(mean_all = mean(all_cnt, na.rm = T),
            mean_HI = mean(HI_cnt, na.rm = T),
            mean_fish = mean(Fisheries, na.rm = T),
            mean_gun = mean(Gunshot, na.rm = T)) %>%
  transform(all_diff = all_cnt - mean_all,
            HI_diff = HI_cnt - mean_HI,
            fish_diff = Fisheries - mean_fish,
            gun_diff = Gunshot - mean_gun) %>%
  transform(mean_val_all = (all_cnt + mean_all)/2) %>%
  transform(perc_diff_all = (all_cnt - mean_all)/mean_val_all*100) %>%
  transform(mean_val_HI = (HI_cnt + mean_HI)/2) %>%
  transform(perc_diff_HI = (HI_cnt - mean_HI)/mean_val_HI*100)

countymapdata_melt_cnt <- countymapdata %>%
  select(subregion, long, lat, group, order, region, all_cnt, HI_cnt) %>%
  melt(id.vars = c('subregion', 'long', 'lat', 'group', 'order', 'region'))

countymapdata_melt_percs <- countymapdata %>%
  select(subregion, long, lat, group, order, region, all_perc, HI_perc) %>%
  melt(id.vars = c('subregion', 'long', 'lat', 'group', 'order', 'region'))

countymapdata_melt_difs <- countymapdata %>%
  select(subregion, long, lat, group, order, region, all_diff, HI_diff) %>%
  melt(id.vars = c('subregion', 'long', 'lat', 'group', 'order', 'region'))

countymapdata_melt_perc_difs <- countymapdata %>%
  select(subregion, long, lat, group, order, region, perc_diff_all, perc_diff_HI) %>%
  melt(id.vars = c('subregion', 'long', 'lat', 'group', 'order', 'region'))


county_perc_diff <- ggplot(countymapdata_melt_perc_difs
                           %>% filter(variable == 'perc_diff_HI')
                           , aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = value), size = 0.2) + xlab("") + ylab("") + coord_fixed(1) +
    annotate("text", x = max(center_locations$long) + 2.6,
                     y = min(center_locations$lat) + 4.25 - 0.18*(15:1),
             label = paste(center_locations$Label,": ",center_locations$Center, sep = ""), size = 2.5, hjust = 0, fontface = 'bold') +
  geom_path(data = map_data("state", region = c("oregon", "washington"), colour = "grey20", size = 0.3)) +
  geom_label_repel(data = center_locations, inherit.aes = FALSE,
                   aes(x = long, y = lat, label = Label), show.legend = TRUE,
    fontface = 'bold', size = 2, color = 'black', fill = 'white',
    force = 0.001) +
theme_classic() +
   theme(legend.position = c(.7, .15),
    axis.line = element_blank(),
    axis.text = element_blank(), axis.ticks = element_blank(),
    strip.text = element_text(size = 9),
    strip.background = element_blank(),
    panel.border = element_blank()) +
    #panel.border = element_rect(colour = "black", fill = NA, size = 1)) +
  scale_fill_gradientn(colors = rainbow12, na.value = "white", name = "Percent Difference",
            guide = guide_colorbar(direction = "horizontal",
      barheight = unit(2, units = "mm"), barwidth = unit(40, units = "mm"),
      draw.ulim = F, title.position = 'top',
      title.hjust = 0.5, label.hjust = 0.5))

HI_type_facet_all <- ggplot(pnw_state_outline) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "grey93", color = "grey50", size = 0.2) +
  coord_fixed(1, ylim = c(42.3, 49.15), xlim = c(-125, -121.8)) +
  # geom_point(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr), color = 'grey20', size = 0.2, alpha = 0.8)  +
  geom_density2d(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr), bins = 3, col = 'red') +
  scale_alpha(range = c(0, 0.1), guide = FALSE) +
  xlab("") + ylab("") +
  facet_grid(Interaction.Type ~ Season) +
  #theme_nothing() +
  theme_classic() +
  theme(plot.margin = unit(c(0, -20, 0, -20), "mm"),
    axis.line = element_blank(),
    strip.text = element_text(size = 12),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    strip.background = element_blank(),
    panel.border = element_rect(colour = "black", fill = NA, size = 1))
# 
HI_type_facet_seas <- ggplot(pnw_state_outline) +
geom_polygon(aes(x = long, y = lat, group = group), fill = "grey93", color = "grey50", size = 0.2) +
  coord_fixed(1, ylim = c(42.3, 49.15), xlim = c(-125, -121.8)) +
  # geom_point(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr), color = 'grey20', size = 0.2, alpha = 0.8)  +
  geom_density2d(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr), bins = 3, col = 'red') +
  scale_alpha(range = c(0, 0.1), guide = FALSE) +
  xlab("") + ylab("") +
  facet_grid(Interaction.Type ~ Season) +
  #theme_nothing() +
  theme_classic() +
  theme(plot.margin = unit(c(0, -20, 0, -20), "mm"),
    axis.line = element_blank(),
    strip.text = element_text(size = 12),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    strip.background = element_blank(),
    panel.border = element_rect(colour = "black", fill = NA, size = 1))
ggsave(filename = "HI_type_facet_seas.pdf", width = 9, height = 11, units = "in", dpi = 300)

```


**Spatio-Temporal Characterization of Pinniped Strandings and Human Interaction Cases in the Pacific Northwest, 1991 - 2016**

Amanda J. Warlick,^1^ Deborah A. Duffield,^2^ Dyanna M. Lambourn,^3^ Steven J. Jeffries,^3^ James M. Rice,^4^ Joseph K. Gaydos,^5^ Jessica L. Huggins,^6^ John Calambokidis,^6^ Lesanna L. Lahner,^7^ Jennifer Olson,^8^ Erin D'Agnese,^9^ Victoria Souze,^10^ Alysha Elsby,^10^ and Stephanie A. Norman^11^

*1. ECS Federal, LLC, 6520 24th Ave NE, Seattle, WA 98115, USA E-mail: amandajwarlick@gmail.com  
2. Biology Department, Portland State University, P.O. Box 751, Portland, Oregon 97207, USA  
3. Washington Department of Fish and Wildlife, Marine Mammal Investigations, 7801 Phillips Rd, Lakewood, Washington, USA  
4. Marine Mammal Institute, Oregon State University, 2030 SE Marine Science Drive, Newport, Oregon 97365, USA  
5. SeaDoc Society, UC Davis Karen C. Drayer Wildlife Health Center–Orcas Island Office, 942 Deer Harbor Road, Eastsound, Washington 98245, USA  
6. Cascadia Research Collective, 218 1/2 W 4th Ave, Olympia, Washington 98501, USA  
7. SR^3^: Sealife Response, Rehab, and Research, Seattle, WA 98275, USA  
8. The Whale Museum, PO Box 945, Friday Harbor, WA 98250, USA  
9. University of California, Davis, School of Veterinary Medicine, One Shields Ave, Davis, California 95616, USA  
10. Whatcom Marine Mammal Stranding Network, Washington USA  
11. Marine-Med: Marine Research, Epidemiology, and Veterinary Medicine, 24255 15th Place SE, Bothell, WA 98021 USA* 

**Abstract**  

Marine mammal strandings can be used as a proxy for pinniped health and the impacts of anthropogenic activities in the local marine environment. Stranding data from 1991-2016 were used to examine regional and temporal patterns in strandings and human interaction cases across age and sex for six species. Over the study period, `r prettyNum(pinnipeds_data %>% dplyr::summarize(n_distinct(National.Database.Number)), big.mark = ",")` pinnipeds were reported stranded along the coasts of Washington and Oregon, `r round(nrow(pinnipeds_data[pinnipeds_data$Findings.of.Human.Interaction == "Y",])/n_distinct(pinnipeds_data$National.Database.Number), 2) * 100`% of which were documented as human interaction cases. Total strandings and the number and prevalence of reported human interaction cases increased over time for most species. All species stranded in higher numbers in Oregon except harbor seals (Phoca vitulina), which stranded predominantly in inland Washington waters. The composition of ages and sexes varied for each species, as did the proportion of strandings identified as human interaction cases. Gunshot wounds and fisheries entanglements constituted the majority of human interaction cases (`r round(nrow(pinnipeds_data[pinnipeds_data$Interaction.Type == "Gunshot",])/(nrow(pinnipeds_data[pinnipeds_data$Findings.of.Human.Interaction == "Y",])), 2) * 100`% and `r round(nrow(pinnipeds_data[pinnipeds_data$Interaction.Type == "Fisheries",])/(nrow(pinnipeds_data[pinnipeds_data$Findings.of.Human.Interaction == "Y",])), 2) * 100`%, respectively), though the prevalence of these cases varied across species and region. Stranding hotspots were different across species and case types of human interactions, likely due to the differential distribution of pinnipeds and human activities along the coast. Despite the challenges and uncertainties inherent in using stranding data as an indicator of pinniped health and anthropogenic impacts, modeling spatio-temporal patterns is useful for stranding response practitioners and natural resource managers when evaluating the scope and magnitude of threats to pinniped populations.


**Key Words:** pinnipeds, stranding, human interactions, spatio-temporal hotspots, Pacific Northwest, anthropogenic impacts. 

**Introduction**  

Pinnipeds are subject to a wide range of natural and human-related causes of illness or injury, and studying the spatio-temporal patterns of pinniped strandings can provide insight into the dynamic and interconnected factors influencing the health of populations vulnerable to human activities. Pinnipeds are often considered sentinels of ocean health (Aguirre & Tabor, 2004; Bossart, 2006; Ross, 2006; Moore, 2008; Bossart, 2011), as they are top predators living at the land-sea interface and strand onshore exhibiting direct evidence of the threats they encounter in their environment. However, factors influencing where and when an animal strands are diverse, numerous, and interdependent, including ocean conditions, prey availability, susceptibility to disease, and changes in abundance, pupping season, or species range (Woodhouse, 1991; Brabyn & McLean, 1992; Wilkinson & Worthy, 1999; Norman et al., 2004; Pyenson, 2010; Osinga et al., 2012; Berini et al., 2015; Johnston et al., 2015). Stranding records can therefore provide insight into marine mammal life history, biology, and changes in their environment due to natural fluctuations and human-related activities. 

Stranding records have been used globally to learn more about the demographics of wild populations, how a population may be affected by ocean conditions, the vulnerabilities of certain demographic groups, and how specific threats or conditions may be changing over time. For instance, strandings of both pinnipeds and cetaceans have been found to correlate with prevailing ocean conditions, changing species abundance and distribution, and increased reporting effort (Norman et al., 2004; Leeney et al., 2008; Pikesley et al., 2014; Berini et al., 2015; Huggins et al., 2015a; Prado et al., 2016). Increased stranding events for seals in the northeast U.S. (Soulen et al., 2013; Johnston et al., 2015) and the Netherlands (Osinga et al., 2012) have been attributed to a combination of these factors.  

On the U.S. West Coast, researchers have extensively studied stranding trends in California sea lions, northern elephant seals, and harbor seals in central California and generally found that strandings and documented human interaction cases have increased over time, that males and pups strand in greatest numbers, and that strandings have been elevated during El Niño events (Stewart & Yochem, 1987; Goldstein et al., 1999; Greig et al., 2005; Melin et al., 2000, 2008, 2010; Moore et al., 2009; Keledjian & Mesnick, 2013). In the Pacific Northwest, researchers have used stranding data to identify trends in mortality rates and causes, primarily for harbor seals (Stroud & Roffe, 1979; Huggins et al., 2013; Lambourn et al., 2013). Norman et al. (2004) identified cetacean stranding hotspots in the Pacific Northwest and attributed the observed summer peak in reported strandings to the seasonal rise in beach attendance and a greater cetacean presence in the area due to seasonal inshore upwelling. Patterns in harbor porpoise and killer whale strandings have been used to examine long-term mortality trends and highlight the importance of consistent stranding response effort and data collection protocols in the region (Barbieri et al., 2013; Huggins et al., 2015a). However, few spatio-temporal analyses have been conducted on long-term stranding patterns for pinnipeds.

We used data from stranding response networks to characterize spatio-temporal trends in age, sex, species, and human interaction cases in Oregon and Washington from 1991-2016, a longer time period than has been assessed to date. We hypothesized that the number of reported strandings and human interaction cases will have risen over the study period due to a combination of growing populations, range expansion, and the enhanced stranding response capacity that occurred in the mid-2000s. We also expected that strandings for different species would not be uniformly distributed along the coast. This study provides summary statistics of stranding data that can be used to further investigate the complexities of co-occurring human and pinniped uses of a diverse and changing coastal landscape. 

The quantity and consistency of information contained within stranding records can vary over time and across regions, particularly in an area such as the Pacific Northwest that is characterized by diverse topography (including remote beaches) and a large number of stranding response groups. Stranding response relies heavily on reports from the public, which can vary by region due to the degree of residential development, public awareness, and community interest (Huggins et al., 2015b). This illustrates the importance of acknowledging and contextualizing the uncertainty and variability inherent in stranding data when using it as a window into the health, status, or threats facing pinniped populations. Despite these caveats, however, stranding records are often the best and only available data. Analyses of stranding data are critical to natural resource managers tasked with assessing and monitoring pinniped populations and are additionally useful to ensure that stranding network practitioners have the necessary resources to study, collect, and evaluate stranded marine animals.

*Study Area and Species*  
The coastlines of Oregon and Washington have variable natural landscapes (*e.g.*, rocky intertidal zones, sandy beaches, estuarine embayments), public accessibility, and degree of development (*e.g.*, residential and commercial districts, shipping channels, ports, fishing activities, state and national parks, ecotourism). Six pinniped species inhabit the coastal and inland waters of the Pacific Northwest for some or all of their lives, each with unique life history characteristics, behavioral traits, local abundance, and dynamic population trends that influence their presence within the study area, and therefore when, where, and how often they strand.

Harbor seals (*Phoca vitulina*) are the most abundant and widely distributed pinniped in Washington State waters and are found along the entire West Coast (Jeffries et al., 2000). Harbor seals are separated into two coastal and three inland stocks (Huber et al., 2012; Carretta et al., 2016). The Oregon/Washington Coast and inland stocks are presumed to have stabilized and reached carrying capacity (Jeffries et al., 2003), with the coastal stock being the largest at approximately 24,700 individuals in 1999 (Carretta et al., 2016). Harbor seals exhibit high haul-out fidelity and choose sites depending on time of day, tides, season, or food availability (Thomas et al., 2011; London et al., 2012). 

California sea lions (*Zalophus californianus*) are the most abundant pinniped off the coast of California, numbering nearly 300,000 individuals and growing approximately 5.4% per year (Carretta et al., 2016). Adult females remain near the primary rookeries off the coast of southern California, making shorter local foraging trips until pups are weaned (Melin et al., 2008). Adult and subadult males make winter migratory foraging trips as far north as Alaska and return south in late spring (Lowry & Forney, 2005). Because of these life history and migratory patterns, individuals found in the Pacific Northwest are usually males utilizing feeding areas in fall, winter, and spring months, though small numbers of females have been sighted in the area and even into Alaska in recent years (Maniscalco et al., 2004). 

Steller sea lions (*Eumetopias jubatus*) range from Japan throughout the North Pacific and south into California. The Eastern distinct population segment has an estimated 60,000 to 75,000 individuals with breeding and haul-out sites located along the coast of southeast Alaska, British Columbia, Washington, Oregon, and California (DeMaster, 2014; Carretta et al., 2016). Population demographics vary by region, with numbers decreasing at California rookeries in recent years but increasing in the northern part of their range (Carretta et al., 2016). During the summer breeding season, adult males remain ashore while females and juveniles make short foraging trips (National Marine Fisheries Service [NMFS], 2013).  

Northern elephant seals (*Mirounga angustirostris*) range from Mexico to the Aleutian Islands, making seasonal migrations from rookeries in California and Oregon to feeding areas in Alaska and the central North Pacific (Zenkovich, 1998; Carretta et al., 2016). The California breeding stock has grown by 3.8% per year in recent decades and was estimated at 179,000 individuals in 2010 (Lowry et al., 2014). Males make spring and fall feeding trips and females make an initial two-month foraging trip after weaning pups in late winter and then another eight-month foraging trip during gestation before returning to the rookery to give birth and breed (Le Beouf et al., 2000). Individuals can be found hauled out during molting in the Pacific Northwest. 

Northern fur seals (*Callorhinus ursinus*) range from southern California far into the North Pacific, with two recognized stocks: California and Eastern Pacific (Carretta et al., 2016). Primary rookeries are located on the Pribilof and Bogoslof Islands in the Bering Sea, and to a lesser extent islands off southern California (the latter comprising just 1% of the population during the summer breeding season) (Gelatt et al., 2015). Individuals may also haul out along the coast in the Pacific Northwest or British Columbia outside of the breeding season. Adults are onshore throughout the summer breeding season and then remain at sea for seven to eight months, with adult females and pups from both stocks migrating to foraging areas off the West Coast (Lea et al., 2009; Orr et al., 2012). 
<!-- Population growth and demographics of the California stock are changing due to the co-occurrence of emigration and El Niño events (citation). -->

Guadalupe fur seals (*Arctocephalus townsendi*) were presumed extinct in the late 1800s but were then sighted again beginning in 1928 (Townsend, 1931). The population is listed as Threatened under the ESA but has been rebuilding, increasing by 13-21% each year (Esperon-Rodriguez & Gallo-Reynoso, 2012). Individuals have been sighted in the Channel Islands and strandings have occurred as far north as Oregon and Washington, suggesting recolonization and expansion of their historic range (Hanni et al., 1997; Lambourn et al., 2015). 
<!-- Similar to other otariids, pupping occurs in early summer with females remaining close to the rookeries and making brief foraging trips for approximately eight months until pups are weaned (Figueroa-Carranza, 1994). -->

**Methods**   

*Data Sources and Characterization*  
Data for this analysis were drawn from the National Marine Fisheries Service national stranding database, which contains standardized “Level A” data from more than 15 contributing network members from Oregon and Washington (last from accessed February 2017), including a field ID number, observation date, stranding location, latitude and longitude coordinates, age, sex, species, stranding condition (live or dead), and other observational comments including visible evidence of injury, illness, or human interaction.  

The total number of pinnipeds reported stranded in Oregon and Washington from 1991 to 2016 (*n* = `r prettyNum(pinnipeds_data %>% dplyr::summarize(n_distinct(National.Database.Number)), big.mark = ",")` records) were characterized according to sex, age class, and species, and then aggregated by month, year, and stranding location (county). Summary statistics were conducted for three separate regions (Oregon coast, Washington coast, inland Washington waters) because stranding response, public accessibility, and species' habitat use in these regions are very different. For this analysis, we assume stranding location can be used as a relative approximation for where strandings and human interactions actually took place, though carcasses can drift for some time before making landfall, and entangled animals can migrate with entangling debris from a different region.  

In addition to examining total stranding cases, the number of human interaction (HI) cases were also analyzed. Human interaction cases are recorded on the Level A stranding intake form, with "Yes," "No," or "could not be determined (CBD)" designations for whether there is evidence of fisheries entanglements, gunshot wounds, boat collisions, or "other" human interactions. Descriptions of "other" human interactions can include indeterminate blunt trauma, dog bites, debris entanglement, oil staining, and humans harassing or illegally picking-up or relocating animals. The “CBD” designation includes a variety of possible situations, ranging from an unexamined animal to an animal with suspected but unconfirmed HI. Thus, the number of confirmed HI cases is a conservative estimate. Records for dead or decomposed animals can be missing specification in certain fields, resulting in "Unknown" or "Unidentified" age, sex, or even species designations, and were therefore only included in analyses of total strandings or HI cases. 

Two measures of the prevalence of HI cases were examined: (1) the annual proportion of total strandings made up of both combined and individual HI types (*e.g.*, number of fisheries entanglements divided by total stranding cases), to reveal variation in the magnitude of HI, independent of changes in population demographics, and (2) the percent composition of HI cases (*e.g.*, number of fisheries entanglements divided by total HI cases) to examine which type(s) of anthropogenic activity may have a greater effect on a given age, sex, or species. It is important to note, however, that stranding response networks with the capacity to conduct detailed necropsies on a higher percentage of stranded individuals will likely report a higher proportion of positive HI findings, while those that conduct fewer or less detailed necropsies may report a higher proportion of CBD determinations. Therefore, results examining the spatial differences in the prevalence of HI cases must be interpreted within this context, though we expect useful information at a broader regional level despite network differences.    

*Statistical Analysis*  
To determine whether the number of strandings were significantly different across categorical variables such as age class,^[Data have not been corrected for the change in the designation of when a pup becomes a “yearling,” obfuscating the distinction between these two categories that could be combined in future analyses. Additionally, the age class categories in general are documented using responders' best judgement, and results must therefore be interpreted with this in mind.] sex, species, or location, we conducted pairwise Kruskal-Wallis Nemenyi tests (\`posthoc.kruskal.nemenyi.test\` function in the PMCMR package) in R (R Development Core Team, 2009) with age class, sex, and species as independent variables and the number of stranding cases as the dependent variable. Summary statistics were examined both at the regional level (*i.e.*, by state) for management-relevant analyses and on a more local level (*i.e.*, by county) useful for stranding response practitioners. 

To determine whether strandings and HI cases have changed over the study period, we examined both the *number* and *prevalence* over time. We used negative binomial general linear model (GLM) regressions for total annual stranding cases against year (\`glm.nb\` function in the MASS R package) to account for overdispersion and correct for standard error estimates that might be biased in a Poisson regression model. Regressions were repeated for total strandings and HI cases for each species. Regression coefficients reported using this technique were back-transformed, resulting in a "fold increase" (*e.g.*, y = 1.051^x^ being equivalent to a 5.1% increase per year). To examine changes in the prevalence of HI cases, we used a binomial logistic GLM regression with the logit link function, resulting in untransformed regression coefficients. Annual timeseries trends were also explored using Chow's breakpoint test (\`sctest\` function in the strucchange R package) to determine whether interannual changes in stranding counts reflect known changes in stranding network capacity, effort, or funding over time. To determine whether strandings exhibited seasonal patterns, post-hoc pairwise Kruskal-Wallis Nemenyi tests were used with month as the independent variable and total monthly stranding cases as the dependent variable. Monthly analyses were conducted using only cases that were recorded as being either alive or freshly dead at the time of observation in order to best capture the temporal component of the stranding event.

To determine possible spatial patterns in overall strandings and HI cases, we again used negative binomial GLM regression and pairwise Kruskal-Wallis Nemenyi tests using stranding location (county) as the independent variable and annual stranding cases as the dependent variable. Stranding hotspot maps were generated with a kernel density estimation (Gatrell et al., 1996) with three and four bins (\`geom_density2d\` function in the ggplot2 R package). This function does not account for the fact that strandings occur only on the coast, so these maps are intended as a qualitative visualization rather than a statistical predictor. 

*Caveats*  
A pinniped is defined as being stranded when it is either dead or still alive on the beach but in need of medical attention or unable to return to the water on its own (Marine Mammal Protection Act of 1972). Animals are also reported by the public when they might be simply resting or molting, and responders frequently monitor these situations (particularly if the animal is located in a populated area) and use their best judgement about whether to document it in the database. Therefore, reported strandings for some species in some areas (particularly for elephant seals and harbor seal pups in inland Washington waters) may over-represent the true number of stranded animals that are sick or injured. We have not excluded these in this analysis because such cases are inconsistently documented across stranding networks and are therefore difficult to systematically extract from such a large sample size. Furthermore, they do represent the true number of cases that require time and resources from response networks.

Stranding response networks in Oregon and Washington are diverse have grown in their capacity over the study period, particularly in the mid-2000s with the implementation of the John H. Prescott Marine Mammal Rescue Assistance Grant Program,^[See http://www.nmfs.noaa.gov/pr/health/prescott/ for more information.] which could in part account for a rise in reported strandings. One of the challenges of using data from this compilation of stranding records is that beach coverage, response capacity, and even data-reporting protocols vary between network members, over time, and across regions (Huggins et al. 2015b). However, when combined, these data illustrate what is known and what remains uncertain about long-term spatio-temporal patterns in strandings and HI cases throughout the region.

Huggins et al. (2015b) found that the proportion of total strandings that were actually reported in this region both changed over time and varied across species, seasons, and network areas. However, this variation likely remains relatively consistent over time. Therefore, while reported strandings underestimate the true volume, the long-term spatio-temporal patterns in sex, age class, and the prevalence of HI cases can be explained by natural and anthropogenic characteristics of the region and respective species.

**Results** 

From 1991-2016, local stranding response networks identified and recorded `r prettyNum(pinnipeds_data %>% dplyr::summarize(n_distinct(National.Database.Number)), big.mark = ",")` stranded pinnipeds along the coasts and inland waters of Oregon and Washington. Approximately `r round(nrow(pinnipeds_data[pinnipeds_data$Observation.Status == "ALIVE",])/n_distinct(pinnipeds_data$National.Database.Number), 2) * 100`% (*n* = `r prettyNum(nrow(pinnipeds_data[pinnipeds_data$Observation.Status == "ALIVE",]), big.mark = ",")`) were alive and `r round(nrow(pinnipeds_data[pinnipeds_data$Observation.Status == "FRESH DEAD",])/n_distinct(pinnipeds_data$National.Database.Number), 2) * 100`% (*n* = `r prettyNum(nrow(pinnipeds_data[pinnipeds_data$Observation.Status == "FRESH DEAD",]), big.mark = ",")`) were freshly dead at the time of recovery, with the remainder being in various states of decomposition. The majority of total strandings over the study period were harbor seals (`r round(species[species$Pinniped.Common.Name == "Harbor seal", "cnt"]/sum(species$cnt), 2)*100`% of all cases) and California sea lions (`r round(species[species$Pinniped.Common.Name == "California sea lion", "cnt"]/sum(species$cnt), 2)*100`%), followed by smaller numbers of Steller sea lions (`r round(species[species$Pinniped.Common.Name == "Steller sea lion", "cnt"]/sum(species$cnt), 2)*100`%), northern elephant seals (`r round(species[species$Pinniped.Common.Name == "Northern elephant seal", "cnt"]/sum(species$cnt), 2)*100`%), Guadalupe fur seals (`r round(species[species$Pinniped.Common.Name == "Guadalupe fur seal", "cnt"]/sum(species$cnt), 2)*100`%), and northern fur seals (`r round(species[species$Pinniped.Common.Name == "Northern fur seal", "cnt"]/sum(species$cnt), 2)*100`%) (`r tbls("species_age_sex_composition_table", display = "cite")`). Annual strandings were significantly different across species over the study period (*χ*^2^ = 9.8, *p* < 0.01), ranging from a median of `r species_year_mean[species_year_mean$Pinniped.Common.Name == 'Northern fur seal', "median"]` per year for northern fur seals to `r species_year_mean[species_year_mean$Pinniped.Common.Name == 'Harbor seal', "median"]` per year for harbor seals (`r figs("species_boxplots", display = "cite")`a). The sex and age composition of strandings varied depending on species, described further below. 

Evidence of human interaction was noted in `r round(nrow(pinnipeds_data[pinnipeds_data$Findings.of.Human.Interaction == "Y",])/n_distinct(pinnipeds_data$National.Database.Number), 2) * 100`% (*n* = `r prettyNum(nrow(pinnipeds_data[pinnipeds_data$Findings.of.Human.Interaction == "Y",]), big.mark = ",")`) of all stranding cases over the study period, including fisheries entanglements (*n* = `r prettyNum(nrow(pinnipeds_data[pinnipeds_data$Interaction.Type == "Fisheries",]), big.mark = ",")`, `r round(nrow(pinnipeds_data[pinnipeds_data$Interaction.Type == "Fisheries",])/(nrow(pinnipeds_data[pinnipeds_data$Findings.of.Human.Interaction == "Y",])), 2) * 100`% of all HI cases), gunshot wounds (*n* = `r nrow(pinnipeds_data[pinnipeds_data$Interaction.Type == "Gunshot",])`, `r round(nrow(pinnipeds_data[pinnipeds_data$Interaction.Type == "Gunshot",])/(nrow(pinnipeds_data[pinnipeds_data$Findings.of.Human.Interaction == "Y",])), 2) * 100`%), boat collision injuries (*n* = `r nrow(pinnipeds_data[pinnipeds_data$Interaction.Type == "Boat",])`, `r round(nrow(pinnipeds_data[pinnipeds_data$Interaction.Type == "Boat",])/(nrow(pinnipeds_data[pinnipeds_data$Findings.of.Human.Interaction == "Y",])), 2) * 100`%), and "other" (*n* = `r nrow(pinnipeds_data[pinnipeds_data$Interaction.Type == "Other",])`, `r round(nrow(pinnipeds_data[pinnipeds_data$Interaction.Type == "Other",])/(nrow(pinnipeds_data[pinnipeds_data$Findings.of.Human.Interaction == "Y",])), 2) * 100`%). Across all species, the proportion of fisheries interactions and boat injuries is similar between males and females, though gunshot wounds are more prevalent for males (driven by the high prevalence of male California sea lions in the sample) (`r tbls("age_sex_composition_table", display = "cite")`). For specific age classes, the number of HI cases is significantly higher in pups (t = 2.9, *p* < 0.01) and adults (t = 5.9, *p* < 0.001) and lower in yearlings (t = -3.7, *p* < 0.001) and subadults (t = -2.8, *p* < 0.01) (`r tbls("age_sex_composition_table", display = "cite")`). Fisheries interactions are the most common type of HI case for yearlings (`r round(age_sex_composition_table[age_sex_composition_table$Class == 'Yearling', "Fisheries Interactions (%)"], 0)`% of all yearling HI cases) and significantly less for pups and adults (`r round(age_sex_composition_table[age_sex_composition_table$Class == 'Adult', "Fisheries Interactions (%)"], 0)`%-`r round(age_sex_composition_table[age_sex_composition_table$Class == 'Pup', "Fisheries Interactions (%)"], 0)`%). Gunshot wounds, however, are most prevalent in adults (`r round(age_sex_composition_table[age_sex_composition_table$Class == 'Adult', "Gunshots (%)"], 0)`% of adult HI cases) and subadults (`r round(age_sex_composition_table[age_sex_composition_table$Class == 'Subadult', "Gunshots (%)"], 0)`%) and less so for pups (`r round(age_sex_composition_table[age_sex_composition_table$Class == 'Pup', "Gunshots (%)"], 0)`%). Boat collisions constitute a small proportion (`r round(min(age_sex_composition_table[4:7, "Boat Injuries (%)"]), 0)`-`r round(max(age_sex_composition_table[4:7, "Boat Injuries (%)"]), 0)`%) of HI cases for all age classes (`r tbls("age_sex_composition_table", display = "cite")`).  Similar to all strandings, harbor seals constituted the majority of HI cases (`r species_HI[species_HI$Pinniped.Common.Name == 'Harbor seal', "prop"]`%) followed by California (`r species_HI[species_HI$Pinniped.Common.Name == 'California sea lion', "prop"]`%) and Steller sea lions (`r species_HI[species_HI$Pinniped.Common.Name == 'Steller sea lion', "prop"]`%) (data not shown). 

*Species*  
Harbor seals - The sex composition of harbor seal strandings was equal between males and females, though `r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Harbor seal', "Unid. Sex (%)"], 0)`% were unidentified (`r tbls("species_age_sex_composition_table", display = "cite")`). Pups amounted to a greater proportion of strandings than that observed in any of the other species (`r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Harbor seal', "Pup (%)"], 0)`%), with adults only making up `r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Harbor seal', "Adult (%)"], 0)`% of strandings (`r tbls("species_age_sex_composition_table", display = "cite")`). Harbor seals are the only species that stranded in greatest numbers in Washington, with `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Harbor seal', "WA Inland (%)"], 0)`% occurring in inland Washington waters. Very few (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Harbor seal', "WA Coast (%)"], 0)`%) harbor seal strandings occurred on the outer Washington coast (`r tbls("species_HI_prop_table", display = "cite")`). Approximately `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Harbor seal', "HI Prevalence (%)"], 0)`% of strandings were HI cases, the majority of which were "other" (exceeding that of any other species), followed by gunshot wounds (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Harbor seal', "Gunshot (%)"], 0)`%) and fisheries entanglements (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Harbor seal', "Fisheries (%)"], 0)`%). Just `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Harbor seal', "Boat (%)"], 0)`% of HI cases were boat collision injuries (`r tbls("species_HI_prop_table", display = "cite")`). 

California sea lions - Approximately `r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'California sea lion', "Male (%)"], 0)`% were identified as male and `r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'California sea lion', "Female (%)"], 0)`% as female (`r tbls("species_age_sex_composition_table", display = "cite")`), unlike the sex composition of other species strandings. Approximately `r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'California sea lion', "Adult (%)"], 0)`% of strandings assigned an age class were identified as adults, unlike other species where the majority were pups and yearlings (`r tbls("species_age_sex_composition_table", display = "cite")`). The majority of strandings (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'California sea lion', "OR (%)"], 0)`%) occurred along the Oregon coast, with almost `r round(species_HI_prop_table[species_HI_prop_table$Species == 'California sea lion', "WA Inland (%)"], 0)`% in inland Washington waters and just `r round(species_HI_prop_table[species_HI_prop_table$Species == 'California sea lion', "WA Coast (%)"], 0)`% along the Washington coast (`r tbls("species_HI_prop_table", display = "cite")`). Approximately `r round(species_HI_prop_table[species_HI_prop_table$Species == 'California sea lion', "HI Prevalence (%)"], 0)`% of strandings were HI cases, the majority of which (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'California sea lion', "Gunshot (%)"], 0)`%) were gunshot wounds. Just `r round(species_HI_prop_table[species_HI_prop_table$Species == 'California sea lion', "Boat (%)"], 0)`% of HI cases were boat collision injuries (`r tbls("species_HI_prop_table", display = "cite")`). 

Steller sea lions - For Steller sea lions, `r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Steller sea lion', "Male (%)"], 0)`% were identified as male and `r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Steller sea lion', "Female (%)"], 0)`% as female (`r tbls("species_age_sex_composition_table", display = "cite")`). Similar to California sea lions, the majority (`r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Steller sea lion', "Adult (%)"], 0)`%) of strandings assigned an age class were identified as adults, unlike other species where the majority were pups and yearlings (`r tbls("species_age_sex_composition_table", display = "cite")`). The majority of strandings (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Steller sea lion', "OR (%)"], 0)`%) occurred along the Oregon coast with the remainder being equally divided between outer Washington coast and inland waters (`r tbls("species_HI_prop_table", display = "cite")`). Approximately `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Steller sea lion', "HI Prevalence (%)"], 0)`% of strandings were HI cases, second only to northern fur seals. Similar to California sea lions, the majority of HI cases were gunshot wounds (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Steller sea lion', "Gunshot (%)"], 0)`%) followed by fisheries entanglements (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Steller sea lion', "Fisheries (%)"], 0)`%). Just `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Steller sea lion', "Boat (%)"], 0)`% of HI cases were boat collision injuries (`r tbls("species_HI_prop_table", display = "cite")`). 

Northern elephant seals - Approximately `r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Northern elephant seal', "Male (%)"], 0)`% were identified as male and only  `r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Northern elephant seal', "Female (%)"], 0)`% female, the lowest of any other species except California sea lions. Northern elephant seal strandings had high percentages of strandings that were not assigned sex (`r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Northern elephant seal', "Unid. Sex (%)"], 0)`%) and age classes (`r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Northern elephant seal', "Unid. Age (%)"], 0)`%). Similar to other species, the majority of strandings (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Northern elephant seal', "OR (%)"], 0)`%) occurred along the Oregon coast (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Northern elephant seal', "WA Inland (%)"], 0)`%) (`r tbls("species_HI_prop_table", display = "cite")`). Northern elephant seals exhibited the lowest proportion of HI cases (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Northern elephant seal', "HI Prevalence (%)"], 0)`%). Similar only to harbor seals, the majority of HI cases were "other", followed closely by gunshot wounds (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Northern elephant seal', "Gunshot (%)"], 0)`%) (`r tbls("species_HI_prop_table", display = "cite")`). 

Guadalupe fur seals - The sex composition of strandings was similar between males and females (`r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Guadalupe fur seal', "Female (%)"], 0)`%) and the overwhelming majority (`r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Guadalupe fur seal', "Yearling (%)"], 0)`%) were identified as yearlings (`r tbls("species_age_sex_composition_table", display = "cite")`). Similar to other species, the majority of strandings (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Guadalupe fur seal', "OR (%)"], 0)`%) occurred along the Oregon coast, followed by the outer Washington coast (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Guadalupe fur seal', "WA Coast (%)"], 0)`%) and fewest in inland Washington waters (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Guadalupe fur seal', "WA Inland (%)"], 0)`%) (`r tbls("species_HI_prop_table", display = "cite")`). Almost `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Guadalupe fur seal', "HI Prevalence (%)"], 0)`% of strandings were HI cases, the majority of which were fisheries entanglements (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Guadalupe fur seal', "Fisheries (%)"], 0)`%), followed by "other" (`r tbls("species_HI_prop_table", display = "cite")`).

Northern fur seals - Strandings exhibited the highest percentage of female strandings (`r round(species_age_sex_composition_table[species_age_sex_composition_table$Species == 'Northern fur seal', "Female (%)"], 0)`%) compared to other species (`r tbls("species_age_sex_composition_table", display = "cite")`). More than half of strandings assigned an age class were identified as pups and yearlings (`r tbls("species_age_sex_composition_table", display = "cite")`). Similar to other species, the majority of strandings (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Northern fur seal', "OR (%)"], 0)`%) occurred along the Oregon coast, followed by the outer Washington coast (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Northern fur seal', "WA Coast (%)"], 0)`%) and fewest in inland Washington waters (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Northern fur seal', "WA Inland (%)"], 0)`%) (`r tbls("species_HI_prop_table", display = "cite")`). Almost `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Northern fur seal', "HI Prevalence (%)"], 0)`% of strandings were HI cases, the highest proportion among all of the species. Similar only to Guadalupe fur seals, the majority of HI cases were fisheries entanglements (`r round(species_HI_prop_table[species_HI_prop_table$Species == 'Northern fur seal', "Fisheries (%)"], 0)`%), followed by "other" (`r tbls("species_HI_prop_table", display = "cite")`).

*Temporal Patterns*  
All stranding cases - Since 1991, the number of reported stranding cases increased significantly over time (z = 5.4, *p* < 0.001), with 2003 being identified as a breakpoint in the timeseries using Chow's test (F = 5.6, *p* < 0.01). An annual average of `r data_by_year %>% filter(Year.of.Observation < 2004) %>% dplyr::summarize(round(mean(cnt), 0))` individuals stranded per year throughout the 1990s up to 2003 and `r data_by_year %>% filter(Year.of.Observation > 2003) %>% dplyr::summarize(round(mean(cnt), 0))` per year since then. However, annual strandings are changing differently over the study period for each species; significantly increasing for harbor seals (z = 6.2, *p* < 0.001), California sea lions (z = 7.7, *p* < 0.001), Steller sea lions (z = 8.3, *p* < 0.001), Guadalupe fur seals (z = 2.0, *p* < 0.05), and northern fur seals (z = 2.2, *p* < 0.05) (`r figs("all_yr_final", display = 'cite')`). Strandings of harbor seals and California sea lions exhibited a peak in 2009 and 2010 (`r figs("all_yr_final", display = 'cite')`a). No significant change was detected for northern elephant seal strandings over time. 

Human interaction cases - The total number of combined HI cases increased significantly from 1991-2016 (z = 7.8, *p* < 0.001) (`r figs("HI_timeseries", display = 'cite')`a). An annual average of `r year_prop_HI %>% filter(Year.of.Observation < 2003) %>% dplyr::summarize(round(mean(Y), 0))` cases were documented per year throughout the 1990s up through 2002 and `r year_prop_HI %>% filter(Year.of.Observation > 2002) %>% dplyr::summarize(round(mean(Y), 0))` per year since 2003. Specifically, there was an increasing number of gunshot wounds (z = 4.6, *p* < 0.001), fisheries entanglements (z = 8.3, *p* < 0.001), and boat injuries (z = 3.3, *p* < 0.01) over the study period (`r figs("HI_timeseries", display = "cite")`b). The prevalence of HI cases (number of HI cases divided by total) has also increased overall (z = 15.5, *p* < 0.001) (`r figs("HI_prev_final", display = "cite")`a) and specifically for gunshot wounds (z = 6.4, *p* < 0.001), fisheries entanglements (z = 5.3, *p* < 0.001), boat injuries (z = 4.2, *p* < 0.001), and "other" (z = 11.6, *p* < 0.001) (`r figs("HI_prev_final", display = "cite")`b). The prevalence of combined HI case types exceeded 20% in 2012, 2013, and 2015.

Examining whether the number of HI cases are changing over time is most meaningful at the species level. Similar to overall strandings, the number of documented HI cases increased for harbor seals (z = 8.7, *p* < 0.001), California sea lions (z = 6.3, *p* < 0.001), Steller sea lions (z = 5.3, *p* < 0.001), and Guadalupe fur seals (z = 2.1, *p* < 0.05) (`r figs("HI_timeseries", display = 'cite')`a). The prevalence of HI cases increased for harbor seals (z = 11.4, *p* < 0.001), California sea lions (z = 3.8, *p* < 0.001), and northern elephant seals (z = 3.5, *p* < 0.001), and decreased for Guadalupe fur seals (`r figs("HI_prev_final", display = "cite")`a). In terms of specific HI case types, the prevalence of gunshot wound cases increased significantly for California sea lions (z = 2.8, *p* < 0.05), fisheries entanglement cases decreased for California sea lions (z = -2.1, *p* < 0.05) and increased for harbor seals (z = 5.4, *p* < 0.001), boat-related injuries increased for harbor seals (z = 3.4, *p* < 0.001), and "other" increased for California sea lions (z = 2.8, *p* < 0.01) and harbor seals (z = 10.4, *p* < 0.001) (data not shown). 
 
A seasonal peak in total strandings was evident, with strandings being significantly different across months of the year (*χ*^2^ = 4615, *p* < 0.001) and highest from May through October. However, the timing of this peak was different for each species (`r figs("monthly_combined_line", display = 'cite')`a). Examining pairwise Tukey comparisons showed that harbor seal strandings were significantly higher from June through September. Though not statistically significant, California sea lion strandings exhibited a peak in May and again from August through November. The age class composition of stranded animals varied seasonally, with pups (just over 90% of which were harbor seals) stranding in higher numbers from June through September (*χ*^2^ = 503.8, *p* < 0.001) (`r figs("monthly_combined_line", display = 'cite')`b). None of the other age classes exhibited statistically significant seasonal stranding patterns. Seasonal patterns were similar across male and female strandings.

The number of combined HI cases was significantly higher in the summer (July) for harbor seals and pups (data not shown). Though not statistically significant, the different HI case types exhibit seasonal patterns (`r figs("monthly_combined_line", display = 'cite')`c) and these depend on region. For example, boat collision cases only occurred from April to October in inland Washington waters and were highest in August. Fisheries entanglements were highest in May and June in Oregon and highest in August in inland Washington waters. Gunshot wound cases exhibited a discrete peak in March on the outer Washington coast when they accounted for 12% of all monthly cases (as opposed to less than 3% the rest of the year). Gunshot wounds were highest in August in inland Washington waters and from April through June in Oregon.

*Spatial Patterns*  
Over the study period, a higher volume and increasing number of strandings occurred along inland Washington waters and along the Oregon coast compared to the outer Washington coast. The proportion of total annual strandings occurring in Oregon ranged from `r min(data_by_year_state_prop$prop.or)`% to `r max(data_by_year_state_prop$prop.or)`%, averaging `r round(mean(data_by_year_state_prop$prop.or))`% for the whole study period. The proportion of annual strandings occurring along the outer Washington coast ranged from `r min(data_by_year_state_prop$prop.wa_coast)`% to `r max(data_by_year_state_prop$prop.wa_coast)`%, averaging `r round(mean(data_by_year_state_prop$prop.wa_coast))`% for the whole study period. The proportion of annual strandings occurring along the shores of inland Washington waters ranged from `r min(data_by_year_state_prop$prop.wa_in)`% to `r max(data_by_year_state_prop$prop.wa_in)`%, averaging `r round(mean(data_by_year_state_prop$prop.wa_in))`% for the whole study period. 

The distribution of HI cases between these three regions was similar to that of overall strandings, with `r round(sum(HI_state_prop$OR_Coast)/sum(HI_state_prop[,2:4])*100, 0)`% of all HI cases occurring in Oregon, `r round(sum(HI_state_prop$Inland_WA)/sum(HI_state_prop[,2:4])*100, 0)`% in inland Washington waters, and the remaining `r round(sum(HI_state_prop$WA_Coast)/sum(HI_state_prop[,2:4])*100, 0)`% along the outer Washington coast (data not shown). However, the distribution of specific types of HI cases was different between the three regions. Human interaction cases on the outer Washington coast were composed primarily of gunshot wounds (`r round((HI_state_prop_sb[HI_state_prop_sb$Interaction.Type == 'Gunshot', "WA_Coast"])/(sum(HI_state_prop_sb$WA_Coast)), 2)*100`%) while cases in inland Washington waters were composed primarily of "other" (`r round((HI_state_prop_sb[HI_state_prop_sb$Interaction.Type == 'Other', "Inland_WA"])/(sum(HI_state_prop_sb$Inland_WA)), 2)*100`%). Cases along the Oregon coast were primarily gunshot wounds (`r round((HI_state_prop_sb[HI_state_prop_sb$Interaction.Type == 'Gunshot', "OR_Coast"])/(sum(HI_state_prop_sb$OR_Coast)), 2)*100`%) and fisheries entanglements (`r round((HI_state_prop_sb[HI_state_prop_sb$Interaction.Type == 'Fisheries', "OR_Coast"])/(sum(HI_state_prop_sb$OR_Coast)), 2)*100`%).  

At the county level, strandings were not evenly distributed along the coast (*χ*^2^ = 1191.3, *p* < 0.001) (`r figs("countyfigure", display = 'cite')`). In Washington, strandings were highest in San Juan, Island, King, Pierce, and Grays Harbor counties. Similarly, the number of HI cases were significantly higher in Grays Harbor, Pierce, and Pacific counties, with a disproportionately higher number of cases in Pacific county compared with all strandings, the majority of which were gunshot wounds (Supplemental Table S1). In Oregon, the majority of strandings occurred in Clatsop, Tillamook, Coos, and Lincoln counties (`r figs("countyfigure", display = 'cite')`). These counties were also where the majority of HI cases occurred, though a disproportionately higher number occurred in Clatsop, the majority of which were gunshot wounds (Supplemental Table S2). One caveat of these county-level results, however, is that counties were not adjusted for the length of the coastline in each.

Stranding hotspots were apparent throughout inland Washington waters for harbor seals, and distributed along the coast for the other species (`r figs("HIstrands_species", display = 'cite')`). These hotspots remained relatively constant across the seasons of the year. Human interaction hotspots generally overlap hotspots of overall strandings, though for some species there are additional HI case hotspots or HI cases are more constricted in space compared to overall strandings (`r figs("HIstrands_species", display = 'cite')`). For example, northern elephant seal HI cases were centered farther north than overall strandings and exhibited an additional HI hotspot in inland Washington waters. Harbor seal and California sea lion human interactions were denser near the mouth of the Columbia River that was not apparent in their overall strandings. Human interaction cases for both Steller sea lions and Guadalupe fur seals were more dense around the mouth of the Columbia River relative to the distribution of overall strandings (`r figs("HIstrands_species", display = 'cite')`). 

Each of the HI case types were concentrated in different areas, with boat collision injuries and fisheries interactions largely occurring throughout inland Washington waters and around the mouth of the Columbia River, while the only hotspot for gunshot wounds was centered around the Columbia River (`r figs("HI_type_facet", display = 'cite')`). These hotspots do shift seasonally. Boat collision cases were most dense in inland Washington waters in the summer and on the coast during winter. Fisheries and gunshot wound cases were only concentrated near Newport, OR during the spring but also exhibited clusters in Puget Sound the rest of the year (Supplemental Figure S1).

**Discussion**  

Our results highlight spatio-temporal stranding hotspots for pinnipeds in Oregon and Washington from 1991-2016. Harbor seals were the most commonly stranded species in inland Washington waters while other species stranded more frequently in Oregon. Age class and sex composition varied by species and a summer stranding peak was evident only for harbor seal pups. The number of strandings and HI cases have increased over time for almost all of the species, though the prevalence of HI cases varied for each species. Stranding and HI case hotspots were evident along the coast and varied for each species and HI case type.

Spatio-temporal patterns in the age and sex of pinniped strandings in Oregon and Washington are different for each of the six species in the study area, as the different life history characteristics of each species largely determines when, where, and how many animals occur -- and therefore strand -- in different areas along the coast. Additionally, the different prey species, mating strategies, and adaptability to environmental changes of each species also affects their likelihood of becoming entangled, shot, or struck by a vessel. It is therefore not surprising that the number and prevalence of HI cases varies across species (`r tbls("species_HI_prop_table", display = "cite")`), similar to the variation noted by others (Moore et al., 2009; Bogomolni et al., 2010). For example, species that forage further offshore would be least likely to encounter vessel traffic, those that haul out at popular beaches might have a higher prevalence of public harassment cases, and those whose foraging overlaps with a particular fishing season or area might have a higher prevalence of entanglements and gunshot wounds. 

Patterns in the distribution and number of strandings along the coast and throughout the year are likely due to the local abundance and life history characteristics of each species. For example, the majority of California sea lion strandings were male and occurred in May as well as the fall, reflecting the fact that males are making foraging migrations through the area while the majority of females largely stay around the rookeries in California (Lowry & Forney, 2005; Melin et al., 2008). These findings are similar to other studies that have found a higher proportion of males for California sea lions (Greig et al., 2005), northern elephant seals (Colegrove et al., 2005), and harp seals (Soulen et al., 2013). In contrast, males and females were more equally represented in Steller sea lion strandings, due to the presence of breeding and rookeries in the study area.  

California and Steller sea lion strandings had a higher proportion of adult cases while the other four species strandings were primarily pups and yearlings. Young animals have been noted as the most prominent age class in other studies, particularly in southern and central California due to the large rookeries in the area (Greig et al., 2005; Goldstein et al., 1999; Hanni & Pyle, 2000; Kaplan Dau et al., 2009). The prevalence of harbor seal pup strandings in inland Washington waters can be attributed to the presence of haul-outs, pupping sites, and a higher density of human population (and therefore reporting rates) in the area. Further analysis of each individual species could potentially elucidate the connections between stranding patterns and the seasonal use of important reproductive and foraging habitat at a finer spatio-temporal scale using known haul-outs (Jeffries et al., 2000), proxies for upwelling, wind patterns, or prey distributions. 

In terms of HI cases, many studies have found a higher number or incidence of HI cases in males of various age classes (but particularly young animals) (Greig et al., 2005, Delong et al., 1990, Kiyota & Baba, 2001; Kaplan Dau et al., 2009), whereas here we found that the proportion of HI cases for combined species was similar for both males and females (~16%). California sea lions (particularly male pups) have been cited as being particularly inquisitive and therefore more likely to become entangled, though their entanglement rate in this study (fisheries cases as a percentage of total HI cases) was second to northern and Guadalupe fur seals and similar to that of Steller sea lions. California and Steller sea lions had the highest proportion of gunshot wounds of any species, possibly due to the higher proportion of adults, which is arguably the most likely age class to be seen as a nuisance animal in the fishing industry. Anecdotal observations made by response practitioners suggest that each species is affected by different types of entangling materials. In Oregon, plastic packing bands and rubber bands (likely from fish bait boxes and crab pots) account for most California sea lion and Steller sea lion entanglements, respectively, while trawl nets are the most prominent in northern fur seal entanglements (*pers comms*, J. Rice 2017).

The overall prevalence of HI cases for all species over the study period was approximately 11%, similar to that observed in California (7.5-16%) and Cape Cod (10%) (Goldstein et al., 1999; Kaplan Dau et al., 2009; Moore et al., 2009; Bogomolni et al., 2010; Keledjian & Mesnick, 2013). Similar to our findings, Colegrove et al. (2005) found the prevalence of HI cases in central California varied annually and was higher in harbor seals than northern elephant seals. Studies have noted northern fur seals as having a relatively high prevalence of entanglement (Fowler, 1987, Delong et al., 1990; Antonelis et al., 2006), similar to the results presented here. The composition of HI types varied considerably across species. Gunshot wounds constituted `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Steller sea lion', "Gunshot (%)"], 0)`% of HI cases for Steller sea lions and `r round(species_HI_prop_table[species_HI_prop_table$Species == 'California sea lion', "Gunshot (%)"], 0)`% for California sea lions, but only `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Harbor seal', "Gunshot (%)"], 0)`% for harbor seals (`r tbls("species_HI_prop_table", display = "cite")`). In contrast, fisheries interactions made up a lower proportion of HI cases for those three species but amounted to `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Guadalupe fur seal', "Fisheries (%)"], 0)`% and `r round(species_HI_prop_table[species_HI_prop_table$Species == 'Northern fur seal', "Fisheries (%)"], 0)`% of HI cases for Guadalupe and northern fur seals, respectively (`r tbls("species_HI_prop_table", display = "cite")`). These observed patterns are likely a combination of the animals' behavioral ecology and the spatio-temporal distribution of human activities. However, as noted above, the prevalence and composition of HI cases can also be influenced by the levels of examination each species typically receives (*i.e.*, Endangered Species Act-listed and infrequently stranded species such as the northern fur seals might garner greater scientific interest and therefore more extensive examinations that would reveal evidence of human interaction). 

*Temporal Patterns*  
Total annual reported strandings significantly increased over the study period, though this pattern is different for each species. Rather than being symptomatic of declining pinniped population health, the increasing number of reported strandings likely reflects growing abundance and enhanced capacity from the Prescott Grant Program that facilitated consistent reporting protocols and more responders covering beaches, as noted by Huggins et al. (2015a).  Additionally, it is important to note that increasing trends are likely not linear over time but are instead driven by spikes in strandings, such as the heightened strandings of California sea lions in Oregon in 2009-2010 (`r figs("all_timeseries", display = 'cite')`) possibly due to a combination of factors, including an outbreak of leptospirosis, poor foraging conditions in California, and increased competition with fisheries. 

Seasonally, the noticeable and extended summer peak in harbor seal strandings throughout the pupping season, depending on the region, with pupping occurring in late Spring along the Oregon coast, in mid-May through June for the outer Washington coast, and July-August in inland Washington waters (Jeffries et al., 2000). Dedicated summer surveys of harbor seal haul-outs could also have contributed to these elevated seasonal strandings. Slightly higher California sea lion strandings in May and the fall reflects the timing of when males are making migratory trips to and from the area.

The number of HI cases increased over the study period for harbor seals, California sea lions, Steller sea lions, and Guadalupe fur seals, mirroring the rise in overall strandings. These changes in the number of certain types of cases for certain species are likely the product of both endogenous factors (those related to the animals and their environment) and exogenous factors (human activities, policies, pollution events). The prevalence of gunshot wounds increased for California sea lions and the prevalence of fisheries entanglements increased for California sea lions and harbor seals. It is difficult to identify possible explanations for these observed trends as both pinniped populations and human activities can be simultaneously changing, additionally complicated by the fact that our ability to detect certain injuries or illnesses also improves over time (Gulland & Hall, 2007). However, it should be possible to compare interannual changes in the number or prevalence of HI to proxies for fishing effort or other human activities, however, consistent data over time and space can be sparse. The possible relationship between oceanographic conditions and observed temporal patterns in strandings and HI cases should be explored in future analyses.

*Spatial Patterns*  
The number and distribution of strandings can be largely explained by the local abundance and demographic characteristics of each species and hotspots are similar to those previously identified for cetaceans and pinnipeds in the area (Norman et al., 2004; Lee, 2016). In Washington, harbor seals primarily stranded throughout inland waters due to the area having a large number of haul-outs, rookeries, and public reporting. In contrast, fewer harbor seal strandings were reported along the outer Washington and southern Oregon coasts, likely due to the fact that many beaches are isolated or inaccessible. Guadalupe fur seal strandings were most dense from the mouth of the Columbia River to Willapa Bay and Grays Harbor on the outer coast (`r figs("HIstrands_species", display = 'cite')`), likely reflecting the fact that few individuals range into inland Washington waters given their highly pelagic nature. Similarly, northern fur seal strandings did not exhibit hotspots in northern or inland Washington, possibly due to individuals spending more time foraging offshore or near rookeries in Alaska. Approximately two-thirds of Steller sea lion strandings occurred in Oregon, likely due to the three large breeding sites along the coast. These results align with findings from other coastal areas where patterns in marine mammal strandings reflect species' local abundance or seasonal distribution (Woodhouse et al., 1991; Norman et al., 2004; Maldini et al., 2005; Leeney et al., 2008; Pyenson, 2010; Peltier et al., 2013; Frungillo & Read, 2014; Pikesley et al., 2014; Johnston et al., 2015).

Over the study area, HI cases were more concentrated in specific places compared to overall strandings. In Washington, human interactions were disproportionately higher in Pacific and Pierce counties, which combined accounted for `r (WAcounties_table[WAcounties_table$County == 'Pacific', 'HI Prevalence (%)'] + WAcounties_table[WAcounties_table$County == 'Pierce', 'HI Prevalence (%)'])`% of HI cases in Washington but less than `r (WAcounties_table[WAcounties_table$County == 'Pacific', 'All Strandings (%)'] + WAcounties_table[WAcounties_table$County == 'Pierce', 'All Strandings (%)'])`% of total strandings. In Pacific county, `r WAcounties_table[WAcounties_table$County == 'Pacific', 'Gunshot (%)']`% of HI cases were gunshot wounds (Supplemental Table S1). The higher percentage of "other" HI cases (blunt trauma, missing appendages, dog bites, oil staining, animal harassment) in inland Washington is likely due to the fact that the majority of those cases involve harbor seal pups that disproportionally strand in the area relative to other regions. The higher percentage of boat-related injuries in inland Washington could be attributed to the presence of ferry, shipping traffic, and recreational boating throughout inland waters. Nearly half of all HI cases in Oregon were recorded in Clatsop, the majority of which were gunshot wounds. Clatsop county includes Astoria, an economically important fishing port, and the area has seen an increased number of fisheries interactions in recent years (Lee, 2016), particularly with animals foraging up into the Columbia River. However, this higher number of HI cases could also be attributed to the higher necropsy rate in the northern part of the state (Lee, 2016). 

*Future Directions*  
This characterization and hotspot mapping analysis is important for informing management and conservation measures and can support decision-making for stranding response practitioners. Though these results present one of the most comprehensive summary statistics of HI cases for pinnipeds in this region, further analysis of each individual species could ascertain whether it is likely that certain age classes overlap to a greater extent in time and space with anthropogenic activities in areas we identified as hotspots for HI cases. While strandings and HI cases can coincide with or have a higher reporting rate from dense human population centers, they can also occur offshore or in more isolated areas, and therefore go undetected. Further refining the parameters of the kernel density function or using cluster analysis (Kulldorff & Nagarwalla, 1995; Kulldorff, 2001, Kreuder et al., 2003; Kulldorff et al., 2005; Norman et al., 2011) could be explored in the future to refine spatio-temporal findings. Additionally, more refined spatio-temporal predictive modeling that includes measures of pinniped abundance, prey distribution, and proxies for oceanographic conditions (as in Evans et al., 2005, Soulen et al., 2013, Peltier et al., 2013, Truchon et al., 2013, and Berini et al., 2015) could further elucidate the spatial distribution of strandings, and therefore areas or species that are at a higher risk for human impacts and in need of management attention. 

**Conclusion**  

Spatio-temporal patterns in the age and sex of pinniped strandings in Oregon and Washington are different for each of the six species in the study area. Patterns in the distribution and number of strandings along the coast and throughout the year are likely due to the local abundance and demographic characteristics of each species, with harbor seal pups stranding primarily throughout inland Washington waters during pupping season, and other species stranding more broadly across all age classes and along the coast. The number of strandings and the number and prevalence of HI cases increased over time, likely due to a combination of changing population dynamics, enhanced stranding response effort, public awareness, improved ease of reporting using personal mobile devices, and continued coastal socioeconomic development. More refined spatio-temporal modeling techniques could further elucidate the connections between stranding hotspots, prey species availability, prevailing oceanographic conditions, and anthropogenic activities that all impact the short and long-term health of these pinniped populations in a changing environment. Stranding hotspot maps show discrete areas of high-density strandings, which are different across species and types of HI cases. Identifying and monitoring stranding hotspots can be helpful in a variety of contexts, including detecting and investigating unusual mortality events, informing disentanglement response or beach clean-up efforts, implementing targeted outreach, establishing baseline health information, and evaluating whether human-related mortalities approach or exceed established limits under the Marine Mammal Protection Act. Stranding data may contain gaps, biases, and inconsistencies, but are an invaluable resource for conservation and management of these marine mammal species.   

**Acknowledgements**  
This research was made possible through the hard work and dedication of all stranding response network work members in the Pacific Northwest, including Cascadia Research Collective, Central Puget Sound Marine Mammal Stranding Network, Dungeness National Wildlife Refuge & Protection Island, Feiro Marine Life Center, Makah Tribe, Marine Animal Rescue Center, MaST Center Stranding Team, Olympic Coast National Marine Sanctuary, Oregon State University Marine Mammal Institute, Port Townsend Marine Science Center, Portland State University, San Juan County Marine Mammal Stranding Network, Seal Sitters, Seaside Aquarium, Sno-King Marine Mammal Response, The Whale Museum, Vashon Hydrophone Project, Washington Dept of Fish and Wildlife Marine Mammal Investigations, and Whatcom Marine Mammal Stranding Network. In addition to the numerous volunteer hours invested in collecting the data presented, many stranding networks were the recipients of numerous U.S. Federal grants through the John H. Prescott Marine Mammal Rescue Assistance Grant Program, which supplied essential funding for this work.

\newpage

**Figures and Tables**  

```{r, fig.height = 8.5, fig.width = 7, fig.align = 'center'}
species_boxplots
```

`r figs("species_boxplots", caption = "Boxplots of (a) annual stranding cases for each species, and (b) annual human interactions by case type.")`

```{r, fig.height = 4.3, fig.width = 7, fig.align = 'center'}
all_yr_final
```

```{r, fig.height = 8.5, fig.width = 7, fig.align = 'center'}
#all_timeseries
```

`r figs("all_yr_final", caption = "(a) Increasing total reported strandings across all species (*n* = 14,939) (black dotted loess regression line) and increasing for harbor seals (y = 1.057^x^, z = 6.2, *p* < 0.001), California sea lions (y = 1.098^x^, z = 7.7, *p* < 0.001), Steller sea lions (y = 1.143^x^, z = 8.3, *p* < 0.001), Guadalupe fur seals (y = 1.159^x^, z = 2.0, *p* < 0.05), and northern fur seals (y = 1.044^x^, z = 2.2, *p* < 0.05).")` 


```{r, fig.height = 8.5, fig.width = 7, fig.align = 'center'}
HI_timeseries
```

`r figs("HI_timeseries", caption = "(a) Annual HI cases combined (black loess regression line) and for each species illustrate increasing cases for harbor seals (y = 1.114^x^, z = 8.7, *p* < 0.001), California sea lions (y = 1.099^x^, z = 6.3, *p* < 0.001), Steller sea lions (y = 1.095^x^, z = 5.3, *p* < 0.001), and Guadalupe fur seals (y = 1.173^x^, z = 2.1, *p* < 0.05)  and (b) increasing number of gunshot wounds (y = 1.073^x^, z = 4.6, *p* < 0.001), fisheries entanglements (y = 1.090^x^, z = 8.3, *p* < 0.001), and boat injuries (y = 1.087^x^, z = 3.3, *p* < 0.01).")`

```{r, fig.height = 8.5, fig.width = 7, fig.align = 'center'}
HI_prev_final

```

`r figs("HI_prev_final", caption = "Prevalence of human interaction cases (a) significantly increasing for all combined species (black dotted regression line, y = 0.06x, z = 15.5, *p* < 0.001) and for harbor seals (y = 0.06x, z = 11.4, *p* < 0.001), California sea lions (y = 0.03x, z = 3.8, *p* < 0.001), and northern elephant seals (y = 0.09x, z = 3.5, *p* < 0.001); (b) increasing for all HI types combined (black dotted regression line, y = 0.06x, z = 15.5, *p* < 0.001) and for each HI case type: gunshot wounds (y = 0.039x, z = 6.4, *p* < 0.001), fisheries entanglements (y = 0.043x, z = 5.3, *p* < 0.001), and boat injuries (y = 0.087x, z = 4.2, *p* < 0.001).")`

```{r, fig.height = 8.5, fig.width = 7, fig.align = 'center'}

monthly_combined_line
```

`r figs("monthly_combined_line", caption = "Mean number of strandings and human interaction cases and confidence interval bands (+/- 1 SE of mean) for each month according to (a) species, (b) age class, and (c) human interaction type.")`



```{r, fig.height = 8.5, fig.width = 7, fig.align = 'center'}
HIstrands_species
```

`r figs("HIstrands_species", caption = "Kernel density contour lines showing overlapping hotspots for all strandings (black) and human interaction cases (red) for all species, with hotspots occurring throughout inland Washington waters for harbor seals and along the outer coast near the mouth of the Columbia River for the other species. Kernel density estimation is calculated for each species separately, so contour lines are intended to show the spatial density of each species relative to itself, not compared to others.")`


```{r, fig.height = 8.5, fig.width = 7, fig.align = 'center'}
HI_type_facet
```

`r figs("HI_type_facet", caption = "Kernel density contour lines showing hotspots of HI cases by type, with fisheries, boat collisions, and other distributed throughout inland Washington waters and at the mouth of the Columbia River, and gunshot wounds centered at the mouth of the Columbia River. Kernel density estimation is calculated for each case type separately, so contour lines are intended to show the spatial density of each type relative to itself, not compared to other case types.")`


```{r, fig.height = 8.5, fig.width = 7, fig.align = 'center'}
# allstrands_species
```

\newpage

`r tbls("species_age_sex_composition_table", caption = "Age and sex composition and weighted averages of all strandings (n = 14,729) by species. Age class composition is derived from the subset of data from 2002-2016.")`
```{r}
kable(species_age_sex_composition_table, align = 'c', format.args = list(big.mark = ","))
```

`r tbls("age_sex_composition_table", caption = "Age and sex composition of all strandings, human interaction (HI) cases, the prevalence of HI (HI cases/all strandings) and the composition of HI cases (HI type/total HI). Age class composition is derived from the subset of data from 2002-2016.")`
```{r age composition table}
kable(age_sex_composition_table, align = 'c', format.args = list(big.mark = ","))
```

`r tbls("species_HI_prop_table", caption = "Number and composition of all strandings (n = 14,729), regional strandings, and human interaction (HI) cases (n = 1,703) identified to species, and the prevalence of HI (HI cases/all strandings) and the composition of HI cases (HI type/total HI).")`

```{r species composition table}
kable(species_HI_prop_table, align = 'c', format.args = list(big.mark = ","))

```

\newpage

**Supplemental Information**

`r tbls("WAcounties_table", caption = "The number and proportion of all strandings and human interaction (HI) cases and the composition of HI cases for each county in Washington (n = 9,419).")`
```{r wacounties}
kable(WAcounties_table, align = 'c', format.args = list(big.mark = ","))

```

`r tbls("ORcounties_table", caption = "The number and proportion of all strandings and human interaction (HI) cases and the composition of HI cases for each county in Oregon (n = 5,310).")`
```{r}
kable(ORcounties_table, align = 'c', format.args = list(big.mark = ","))

```

```{r, fig.height = 8.5, fig.width = 8, fig.align = 'center'}
HI_type_facet_seas
```
`r figs("HI_type_facet_seas", caption = "Kernel density map of human interaction cases for each season of the year. Kernel density estimation is calculated for each season and HI type separately, so contour lines are intended to show the spatial density of each panel relative to itself, not compared to others.")`

\newpage

**Literature Cited**  

Aguirre A.A., & Tabor G.M. (2004). Marine vertebrates as sentinels of marine ecosystem health. EcoHealth. 1: 236–238. DOI: 10.1007/s10393-004-0091-9
Antonelis, G.A., Baker, J.D., Johanos, T.C., Braun, R.C., & Harting, A.L. (2006). Hawaiian monk seal (Monachus schauinslandi): status and conservation issues. Atoll Research Bulletin 543: 75–101.

Barbieri, M., Raverty, S., Hanson, M.B., Venn-Watson, S., Ford, J.K., & Gaydos, J.K. (2013). Spatial and temporal analysis of killer whale (Orcinus orca) strandings in the North Pacific Ocean and the benefits of a coordinated stranding response protocol. Marine Mammal Science 29.4: E448-E462. DOI: 10.1111/mms.12044

Berini, C. R., Kracker, L. M., & McFee, W.E. (2015). Modeling pygmy sperm whale (Kogia breviceps) strandings along the southeast coast of the United States from 1992 to 2006 in relation to environmental factors. NOAA Technical Memorandum NOS NCCOS 203. 44 pp.

Bogomolni, A., Pugliares, K.R., Sharp, S.M., Patchett, K., Harry, C.T., LaRocque, J.M., Touhey, K.M., & Moore, M. (2010). Mortality trends of stranded marine mammals on Cape Cod and southeastern Massachusetts, USA, 2000 to 2006. Diseases of Aquatic Organisms 88: 143-155. DOI: 10.3354/dao02146

Bossart, G.D. (2006). Marine mammals as sentinels species for oceans and human health. Oceanography 19(2): 134-37. DOI: 10.5670/oceanog.2006.77.
Bossart, G.D. (2011). Marine mammals as sentinel species for oceans and human health. Veterinary Pathology 48(3): 676-90. DOI: 10.1177/0300985810388525

Brabyn, M. W., & McLean, I. G. (1992). Oceanography and coastal topography of herd stranding sites for whales in New Zealand. Journal of Mammalogy 73: 469–76.

Carretta, J.V., Oleson, E.M., Baker, J., Weller, D.W., Lang, A.R., Baker, J.,… Brownell, R.L. (2016). U.S. Pacific marine mammal stock assessments: 2015. NOAA-TM-NMFS-SWFSC-561. Washington, DC. National Oceanic and Atmospheric Administration.

Colegrove, K.M., Greig, D.J., & Gulland, F.M.D. (2005). Causes of live strandings of northern elephant seals and Pacific harbor seals along the central California coast, 1992-2001. Aquatic Mammals 31(1): 1-10. DOI: 10.1578/AM.31.1.2005.1

DeLong, R.L., Gearin, P.J., Bengston, J.L., Dawson, P., & Feldkamp, S.D. (1990). Studies of the effects of entanglement on individual northern fur seals. In: R.S. Shomura and M.L. Godfrey (eds.), Proceedings of the Second International Conference on Marine Debris, 2–7 April, 1989, Honolulu, Hawaii. NOAA Technical Memorandum NMFS SWFSC 154. pp. 492–493.

DeMaster, D. (2014). Results of Steller sea lion surveys in Alaska, June-July 2013. Memorandum to J. Balsiger, J. Kurland, B. Gerke, and L. Rotterman, NMFS Alaska Regional Office, Juneau AK. Alaska Fisheries Science Center, NMFS, 7600 Sand Point Way NE, Seattle, WA 98115.

Esperon-Rodriguez, M., & Gallo-Reynoso, J.P. (2012). The re-colonization of the Archipelago of San Benito, Baja California, by the Guadalupe fur seal. Revista Mexicana de Biodiversidad 83:170-176.

Evans, K., Thresher, R., Warneke, R., Bradshaw, C.J.A., Pook, M., Thiele, D., & Hindell, M.A. (2005). Periodic variability in cetacean strandings: links to large-scale climate events. Biology Letters 1(2): 147-150. DOI: 10.1098/rsbl.2005.0313

Fowler, C.W. (1987). Marine debris and northern fur seals: a case study. Marine Pollution Bulletin 18: 326–335.

Frungillo, J., & Read, A. (2014). An analysis of gray and harbor seal strandings in Cape Cod, MA from 1999 to 2012. Master’s thesis project, Nicholas School of the Environment of Duke University, NC.

Gatrell, A.C., Bailey, T.C., Diggle, P., & Rowlingson, B.S. (1996). Spatial Point Pattern Analysis and its Application in Geographical Epidemiology, Transactions of the Institute of British Geography 2: 256- 274.

Gelatt, T., Ream, R., & Johnson, D. (2015). Callorhinus ursinus. The IUCN Red List of Threatened Species 2015:e.T3590A45224953. http://www.iucnredlist.org/details/3590/0

Goldstein, T., Johnson, S.P., Phillips, A.V., Hanni, K.D., Fauquier, D.A., & Gulland, F.M.D. (1999). Human-related injuries observed in live stranded pinnipeds along the central California coast 1986–1998. Aquatic Mammals 25: 43–51.

Greig, D. J., Gulland, F. M. D., & Kreuder, C. (2005). A decade of live California sea lion (Zalophus californianus) strandings along the central California coast: Causes and trends, 1991-2000. Aquatic Mammals 31(1): 11-22. DOI: 10.1578/AM.31.1.2005.11

Gulland, F.M.D., & Hall, A.J. (2007). Is marine mammal health deteriorating? Trends in the global reporting of marine mammal disease. EcoHealth 4(2): 135-150. DOI: 10.1007/s10393-007-0097-1

Hanni, K.D., Long, D.J., Jones, R.E., Pyle, P., & Morgan, L.E. (1997). Sightings and strandings of Guadalupe fur seals in central and northern California, 1988-1995. Journal of Mammalogy 78(2): 684-690.

Hanni, K.D., & Pyle, P. (2000). Entanglement of pinnipeds in synthetic materials at south-east Farallon Island, California, 1976–1998. Marine Pollution Bulletin 40: 1076–1081. DOI: 10.1016/S0025-326X(00)00050-3

Huber, H.R., Dickerson, B.R., Jeffries, S.J.& Lambourn, D.M. (2012). Genetic analysis of Washington State harbor seals (Phoca vitulina richardii) using microsatellites. Canadian Journal of Zoology 90(12): 1361-1369. DOI: 10.1139/cjz-2012-0047

Huggins, J.L., Leahy, C.L., Calambokidis, J., Lambourn, D., Jeffries, S.J., Norman, S.A., & Raverty, S. (2013). Causes and patterns of harbor seal (Phoca vitulina) pup mortality at Smith Island, Washington, 2004-2010. Northwestern Naturalist 94(3): 198-208. DOI: 10.1898/12-14.1

Huggins, J. L., Raverty, S. A., Norman, S. A., Calambokidis, J., Gaydos, J. K., Duffield, D. A., ... Barre, L. (2015a). Increased harbor porpoise mortality in the Pacific Northwest, USA: understanding when higher levels may be normal. Diseases of Aquatic Organisms, 115(2), 93-102. DOI: 10.3354/dao02887

Huggins, J.L, Oliver, J., Lambourn, D.M., Calambokidis, J., Diehl, B. & Jeffries, S. (2015b). Dedicated beach surveys along the central Washington coast reveal a high proportion of unreported marine mammal strandings. Marine Mammal Science 31(2): 782-789. DOI: 10.1111/mms.12184

Jeffries, S.J., P.J. Gearin, H.R. Huber, D.L. Saul, & Pruett, D.A. (2000). Atlas of Seal and Sea Lion haul-out Sites in Washington. Washington Department of Fish and Wildlife, Wildlife Science Division, 600 Capitol Way North, Olympia WA. pp. 150.

Jeffries, S. J., Huber, H. R., Calambokidis, J. & Laake, J. (2003). Trends and status of harbor seals in Washington State: 1978–1999. Journal of Wildlife Management 67:207–218.

Johnston, D.W., Frungillo, J., Smith, A., Moore, K., Sharp, B., Schuh, J. & Read, A. (2015). Trends in stranding and bycatch rates of gray and harbor seals along the Northeastern coast of the U.S.: evidence of divergence in the abundance of two sympatric phocid species? PLoS One 10(7): e0131660.

Kaplan Dau, B., Gilardi, K.V.K., Gulland, F.M., Higgins, A., Holcomb, J.B., St. Leger, J., & Ziccardi, M.H. (2009). Fishing gear-related injury in California marine wildlife. Journal of Wildlife Diseases 45(2): 355-362. DOI: 10.7589/0090-3558-45.2.355

Keledjian, A.J., & Mesnick, S. (2013). The Impacts of El Niño Conditions on California. Sea Lion Fisheries Interactions: Predicting Spatial and Temporal Hotspots along the California Coast. Aquatic Mammals 39(3), 221-232. DOI: 10.1578/am.39.3.2013.221

Kiyota, M. & Baba, N. (2001). Entanglement in marine debris among adult female northern fur seals at St. Paul Island, Alaska in 1991–1999. Bulletin of the National Research Institute of Far Seas Fisheries 38: 13-20.

Kreuder, C., Miller, M.A., Jessup, D.A., Lowenstine, L.J., Harris, M.D., Ames, J.A., Carpenter, T.E., Conrad, P.A., & Mazet, J.A. (2003). Patterns of mortality in southern sea otters (Enhydra lutras nereis) from 1998–2001. Journal of Wildlife Diseases 39:495–509. DOI: 10.7589/0090-3558-39.3.495

Kulldorff, M., & Nagarwalla, N. (1995). Spatial disease clusters: Detection and inference. Statistical Methods 14:799–810.

Kulldorff, M. (2001). Prospective time periodic geographical disease surveillance using a scan statistic. Journal of Royal Statistical Society 164(1): 61-72.

Kulldorff, M., Heffernan, R., Hartman, J., Assuncao, R., & Mostashari, F. (2005). A space-time permutation scan statistic for disease outbreak detection. PLoS Med 2(3): e59.

Lambourn, D.M., Garner, M., Ewalt, D., Raverty, S., Sidor, I., Jeffries, S. Rhyan, J., & Gaydos, J.K. (2013). Brucella pinnipedialis infections in Pacific harbor seals from Washington State, USA. Journal of Wildlife Disease 49(4): 802-815. DOI: 10.7589/2012-05-137.

Lambourn, D., D’Agnese, E., Jeffries, S., Wilkinson, K., Huggins, J., Rice, J., Duffield, D., Smith, W., Grigg, M., & Raverty, S. (2015). Return of the Guadalupe fur seal to the Pacific Northwest: Stranding and sightings. 21st Biennial Conference on the Biology of Marine Mammals. Dec. 13-18. San Francisco, CA.

Leeney, R.H., Amies, R., Broderick, A.C., Witt, M.J., Loveridge, J., Doyle, J., & Godley, B.J. (2008). Spatio-temporal analysis of cetacean strandings and bycatch in a UK fisheries hotspot. Biodiversity and Conservation 17: 2323. DOI: 10.1007/s10531-008-9377-5

Le Boeuf, B.J., Crocker, D.E., Costa, D.P., Blackwell, S.B., Webb, P.M., & Houser, D.S. (2000). Foraging ecology of northern elephant seals. Ecological monographs 70(3): 353-382.

Lea, M.A., Johnson, D., Ream, R., Sterling, J., Melin, S., & Gelatt, T. (2009). Extreme weather events influence dispersal of naïve northern fur seals. Biology Letters 5: 252–257. DOI: 10.1098/rsbl.2008.0643

Lee, K. (2016). Stranding mortality patterns in California sea lions and Steller sea lions in Oregon and southern Washington, 2006 to 2014. Dissertations and Theses. Paper 2995. Portland State University.

London, J.M., Ver Hoef, J.M., Jeffries, S.J., Lance, M.M., & Boveng, P.L. (2012). Haul-out behavior of harbor seals (Phoca vitulina) in Hood Canal, Washington. PLoS One 7(6): e38180.

Lowry, M.S. & Forney, K.A. (2005). Abundance and distribution of California sea lions (Zalophus californianus) in central and northern California during 1998 and summer 1999. Fishery Bulletin 103:331-343.

Lowry, M.S., R. Condit, B.Hatfield, S.G. Allen, R. Berger, P.A. Morris, B.J. Le Boeuf, & Reiter, J. (2014). Abundance, Distribution, and Population Growth of the Northern Elephant Seal (Mirounga angustirostris) in the United States from 1991 to 2010. Aquatic Mammals 40(1): 20-31. DOI: 10.1578/AM.40.1.2014.20

Maldini, D., Mazzuca, L., & Atkinson, S. (2005). Odontocete stranding patterns in the main Hawaiian Islands (1937–2002): how do they compare with live animal surveys? Pacific Science 59, 55–67.

Maniscalco, J.M., Wynne, K., Pitcher, K.W., Hanson, M.B., Melin, S.R., & Atkinson, S. (2004). The occurrence of California sea lions (Zalophus californianus) in Alaska. Aquatic Mammals 30(3): 427-433. DOI: 10.1578/AM.30.3.2004.427

Melin, S.R., DeLong, R.L., & Thomason, J.R. (2000). Attendance patterns of California sea lion (Zalophus californianus) females and pups during the non-breeding season at San Miguel Island. Marine Mammal Science 16(1): 169-185. DOI: 10.1111/j.1748-7692.2000.tb00911.x

Melin, S. R., DeLong, R. L., & Siniff, D. (2008). The effects of El Niño on the foraging behavior of lactating California sea lions (Zalophus californianus) during the non-breeding season. Canadian Journal of Zoology 86: 192-206. DOI: 10.1139/Z07-132

Melin, S.R., Orr, A.J., Harris, J.D., Laake, J.L., & DeLong, R.L. (2010). Unprecedented mortality of California sea lion pups associated with anomalous oceanographic conditions along the central California coast in 2009. California Cooperative Oceanic Fisheries Investigations Report 51: 182-194.

Moore, S.E. (2008). Marine mammals as ecosystem sentinels. Journal of Mammalogy 89(3): 534–540. DOI: 10.1644/07-MAMM-S-312R1.1

Moore, S.E., Lyday, S., Roletto, J., Litle, K., Parrish, J.K., Nevins, H., ... Kell, S. (2009). Entanglements of marine mammals and seabirds in central California and the north-west coast of the United States 2001-2005. Marine Pollution Bulletin. 58: 1045-1051.

National Marine Fisheries Service. (2008). Recovery Plan for the Steller Sea Lion (Eumetopias jubatus). Revision. National Marine Fisheries Service, Silver Spring, MD. 325 pp.
National Marine Fisheries Service. (2013). Status Review of The Eastern Distinct Population Segment of Steller Sea Lion (Eumetopias jubatus). 144pp. Protected Resources Division, Alaska Region, National Marine Fisheries Service, 709 West 9th St, Juneau, Alaska 99802.

Norman, S.A., Bowlby, C.E., Brancato, M.S., Calambokidis, J., Duffield, D., Gearin, P.J.,... Scordino, J. (2004). Cetacean strandings in Oregon and Washington between 1930 and 2002. Journal of Cetacean Research and Management 6:87–99.

Norman, S.A., Huggins, J., Carpenter, T.E., Case, J.T., Lambourn, D.M., Rice, J.,… Klope, M. (2011). The application of GIS and spatio-temporal analyses to investigations of unusual marine mammal strandings and mortality events. Marine Mammal Science 28(3): E251-E266. DOI: 10.1111/j.1748-7692.2011.00507.x

Orr, A.J., Melin, S.R., Harris, J.D., & DeLong, R.L. (2012). Status of the northern fur seal population at San Miguel Island, California during 2010 and 2011. Pp. 41-58, In: Testa, J. W. (ed.), Fur seal investigations, 2010-2011. U.S. Dep. Commer., NOAA Tech. Memo. NMFS-AFSC-241. 77 pp.

Osinga, N., Shahi Ferdous, M.M., Morick, D., Garcia Hartmann, M., Ulloa, J.A., Vedder, L.,… Kuiken, T. (2012). Patterns of Stranding and Mortality in Common Seals (Phoca vitulina) and Grey Seals (Halichoerus grypus) in The Netherlands between 1979 and 2008. Journal of Comparative Pathology 147(4): 1-16.

Peltier, H., Baagøe H.J., Camphuysen K.C.J., Czeck R., Dabin W., Daniel P.,… Ridoux, V. (2013). The Stranding Anomaly as Population Indicator: The Case of Harbour Porpoise (Phocoena phocoena) in North-Western Europe. PLoS One 8(4): e62180.

Pikesley, S.K., Witt, M.J., Hardy, T., Loveridge, J., Loveridge, J., Williams, R., & Godley, B.J. (2012). Cetacean sightings and strandings: evidence for spatial and temporal trends? Journal of the Marine Biological Association of the United Kingdom: 1-12.

Prado, J.H.F, Mattos, P.H., Silva, K.G, & Secchi, E.R. (2016). Long-term seasonal and interannual patterns of marine mammal strandings in subtropical Western South Atlantic. PLoS One 11(1): e0146339.

Pyenson, N.D. (2010). Carcasses on the coastline: measuring the ecological fidelity of the cetacean stranding record in the eastern North Pacific Ocean. Paleobiology 36: 453–480.

R Development Core Team. (2009). R: a language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. http://www.R-project.org.

Ross, P.S. (2000). Marine mammals as sentinels in ecological risk assessment. Human and Ecological Risk Assessment 6(1): 29–46.

Soulen, B.K., Cammen, K., Schultz, T.F., & Johnston, D.W. (2013). Factors Affecting Harp Seal (Pagophilus groenlandicus) Strandings in the Northwest Atlantic. PloS One 8(7): e68779.

Stewart, B.S., & Yochem, P.K. (1987). Entanglement of pinnipeds in synthetic debris and fishing net and line fragments at San Nicolas and San Miguel islands, California, 1978-1986. Marine Pollution Bulletin 18: 336-339.

Stroud, R.K., & Roffe, T.J. (1979). Causes of death in marine mammals stranded along the Oregon coast. Journal of Wildlife Diseases 15(1): 91-97.

Thomas, A.C., Lance, M.M, Jeffries, S.J., Miner, B.G., & Acevedo-Gutiérrez, A. (2011). Harbor seal foraging response to a seasonal resource pulse, spawning Pacific herring. Marine Ecology Progress Series 441:225–239. DOI: 10.3354/meps09370.

Townsend, C.H. (1931). The fur seal of the California islands with new descriptive and historical matter. Zoologica 9: 442-457.

Truchon M.-H., Measures L., L’Herault V., Brethes J.-C., Galbraith P.S., Harvey, M.,… Lecomte, N. (2013). Marine Mammal Strandings and Environmental Changes: A 15-Year Study in the St. Lawrence Ecosystem. PLoS ONE 8(3): e59311. doi:10.1371/journal.pone.0059311.

Wilkinson, D. & Worthy, G. (1999). In: Conservation and Management of Marine Mammals (Twiss, J. R. and R.R. Reeves, eds.). Smithsonian Institute Press, Washington, pp. 396-411.

Woodhouse, C.D. (1991). Marine mammal beachings as indicators of population events. Marine mammal strandings in the United States: proceedings of the second marine mammal stranding workshop. US Dep Commerce., NOAA Technical Report. NMFS 98:111-115. 157pp.

Zenkovich, B. (1998). The northern elephant seal in Oregon: A pupping range extension and onshore occurrence. Notes 87:3.



```{r unused figures}

#from figure, before switch to ggplot

# #HI type facet map
# HI_type_facet <- ggmap(get_googlemap(center = 'Portland, OR', maptype = "terrain", zoom = 6, size = c(640, 640), style = c(feature = "all", element = "labels", visibility = "off"))) +
#   geom_point(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr), color = 'grey20', size = 0.2, alpha = 0.8)  +
#   geom_density2d(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr), bins = 5, col = 'grey30') +
#   scale_alpha(range = c(0, 0.1), guide = FALSE) +
#   xlab("") + ylab("") +
#   facet_wrap(~ Interaction.Type) +
#   scale_x_continuous(limits = c(-127, -120)) + scale_y_continuous(limits = c(42.8, 49.05)) +
#    theme(plot.margin = unit(c(0, -10, 0, -10), "mm"),
#     axis.line = element_blank(),
#     #axis.ticks = element_blank(),
#     #axis.text = element_blank(),
#     strip.text = element_text(size = 10),
#     strip.background = element_blank(),
#     panel.border = element_rect(colour = "black", fill = NA, size = 1))
#   
# figs("HI_type_facet", caption = "Strandings (grey points) and kernel density hotspot contour lines showing hotspots of human interaction cases, with fisheries and boat collisions distributed throughout inland Washington waters and at the mouth of the Columbia River, and a gunshot wound cluster centered at the mouth of the Columbia River.")
# 
# #HI and strandings - species facet, red and black
# HIstrands_species <-
#  ggmap(get_googlemap(center = 'Portland, OR', maptype = "terrain", zoom = 6, size = c(640, 640), style = c(feature = "all", element = "labels", visibility = "off"))) +
#   geom_point(data = pinnipeds_data_mapping_sp %>% filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'), 
#              aes(x = long_corr, y = lat_corr), col = 'grey35', size = 0.2, alpha = 0.5)  +
#   geom_density2d(data = pinnipeds_data_mapping_sp %>% filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'), aes(x = long_corr, y = lat_corr, weight = weight), bins = 3, col = 'red') +
#   geom_density2d(data = pinnipeds_data_mapping_sp, aes(x = long_corr, y = lat_corr, weight = weight), bins = 2, col = 'grey20') +  scale_alpha(range = c(0, 0.1), guide = FALSE) +
#   xlab("") + ylab("") +
#   facet_wrap(~ Pinniped.Common.Name) +
#   scale_x_continuous(limits = c(-127, -120)) + scale_y_continuous(limits = c(42.9, 48.95)) +
#    theme(plot.margin = unit(c(0, -5, 0, -5), "mm"),
#     axis.line = element_blank(),
#     #axis.ticks = element_blank(),
#     #axis.text = element_blank(),
#     strip.text = element_text(size = 10),
#     strip.background = element_blank(),
#     panel.border = element_rect(colour = "black", fill = NA, size = 1))
# 
# figs("HIstrands_species", caption = "Strandings (grey points) and kernel density hotspot contour lines showing overlapping hotspots for all strandings (black) and human interaction cases (red) for all species, with hotspots occurring throughout inland Washington for harbor seals and along the outer coast near the mouth of the Columbia River for the other species.")



#county lines
# counties <- tolower(unique(pinnipeds_data_mapping_sp$County)) 
# 
# pnw_outline <- map_data("county", region = c("oregon", "washington")) %>%
#   filter(subregion %in% counties) %>%
#   mutate(subregion = ifelse(region == 'washington' & subregion == 'lincoln', 'NA',
#                             ifelse(region == 'washington' & subregion == 'douglas', 'NA',
#                                    ifelse(region == 'oregon' & subregion == 'jefferson', 'NA',
#                                           ifelse(region == 'washington' & subregion == 'columbia', 'NA', subregion))))) %>%
#   filter(subregion != 'NA')

# pnw_map <- ggplot(pnw_outline) +
# geom_polygon(aes(x = long, y = lat, group = group), fill = "grey", color = "black") + 
#   coord_fixed(1.3) + 
#   geom_point(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr), color = 'grey20', size = 0.2, alpha = 0.8)  +
#   geom_density2d(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr), bins = 5, col = 'grey30') +
#   scale_alpha(range = c(0, 0.1), guide = FALSE) +
#   xlab("") + ylab("") +
#   #facet_wrap(~ Interaction.Type) +
#   scale_x_continuous(limits = c(-127, -120)) + scale_y_continuous(limits = c(42.8, 49.05)) + 
#   #theme_nothing() +
#   theme(plot.margin = unit(c(0, -10, 0, -10), "mm"),
#     axis.line = element_blank(),
#     #axis.ticks = element_blank(),
#     #axis.text = element_blank(),
#     strip.text = element_text(size = 10),
#     strip.background = element_blank(),
#     panel.border = element_rect(colour = "black", fill = NA, size = 1))

#play with qmplot
# test <- qmplot(long_corr, lat_corr, data = pinnipeds_data_mapping_HI,
#                geom = "density2d")


#All strandings - species facet
# allstrands_species <-
#  ggmap(get_googlemap(center = 'Portland, OR', maptype = "terrain", zoom = 6, size = c(640, 640), style = c(feature = "all", element = "labels", visibility = "off"))) +
#   geom_point(data = pinnipeds_data_mapping_sp, aes(x = long_corr, y = lat_corr), color = 'grey40', size = 0.2, alpha = 0.8)  +
#   geom_density2d(data = pinnipeds_data_mapping_sp, aes(x = long_corr, y = lat_corr), bins = 3, col = 'grey20', h = c(5, 0.5)) +
#   # stat_density2d(data = pinnipeds_data_mapping_sp, aes(x = long_corr, y = lat_corr, fill = ..level.., alpha = ..level..), size = 0.1, geom = "polygon") +
#   # scale_fill_gradient(low = "yellow", high = "red", guide = FALSE) +
#   scale_alpha(range = c(0, 0.1), guide = FALSE) +
#   xlab("") + ylab("") +
#   facet_wrap(~ Pinniped.Common.Name) +
#   scale_x_continuous(limits = c(-127, -120)) + scale_y_continuous(limits = c(42.8, 49.05)) +
#    theme(plot.margin = unit(c(0, -5, 0, -5), "mm"),
#     axis.line = element_blank(),
#     axis.ticks = element_blank(),
#     axis.text = element_blank(),
#     strip.text = element_text(size = 10),
#     strip.background = element_blank(),
#     panel.border = element_rect(colour = "black", fill = NA, size = 5))
# 
# figs("allstrands_species", caption = "All stranding cases (grey points) and kernel density hotspot contour lines showing stranding hotspots for each species, with hotspots occurring in the Salish Sea for harbor seals and along the outer coast near the mouth of the Columbia River for the other species.")

#Checking whether hotspots have changed over time - definitely sort of has
# HIstrands_yr <-
#  ggmap(get_googlemap(center = 'Portland, OR', maptype = "terrain", zoom = 6, size = c(640, 640), style = c(feature = "all", element = "labels", visibility = "off"))) +
#   # geom_point(data = pinnipeds_data_mapping_sp %>% filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'), aes(x = long_corr, y = lat_corr), color = 'grey50', size = 0.3, alpha = 0.5)  +
#   geom_density2d(data = pinnipeds_data_mapping %>% filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA') %>% filter(Year.of.Observation == 1990 |
#                    Year.of.Observation == 1995 |
#                    Year.of.Observation == 2000 | 
#                    Year.of.Observation == 2005 |
#                    Year.of.Observation == 2010 |
#                    Year.of.Observation == 2015), aes(x = long_corr, y = lat_corr), bins = 3, col = 'red') +
#   geom_density2d(data = pinnipeds_data_mapping %>% 
#                    filter(Year.of.Observation == 1990 |
#                    Year.of.Observation == 1995 |
#                    Year.of.Observation == 2000 | 
#                    Year.of.Observation == 2005 |
#                    Year.of.Observation == 2010 |
#                    Year.of.Observation == 2015), aes(x = long_corr, y = lat_corr), bins = 2, col = 'grey20') +
#   scale_alpha(range = c(0, 0.1), guide = FALSE) +
#   xlab("") + ylab("") +
#   facet_wrap(~ Year.of.Observation) +
#   scale_x_continuous(limits = c(-127, -120)) + scale_y_continuous(limits = c(42, 49.65)) +
#    theme(plot.margin = unit(c(0, -5, 0, -5), "mm"),
#     axis.line = element_blank(),
#     axis.ticks = element_blank(),
#     axis.text = element_blank(),
#     strip.text = element_text(size = 10),
#     strip.background = element_blank(),
#     panel.border = element_rect(colour = "black", fill = NA, size = 5))


#Option with overlapping HI types
# HI_overlap <-
#  ggmap(get_googlemap(center = 'Portland, OR', maptype = "terrain", zoom = 6, size = c(640, 640), style = c(feature = "all", element = "labels", visibility = "off"))) +
#   geom_point(data = pinnipeds_data_mapping_HI, 
#              aes(x = long_corr, y = lat_corr), color = 'grey30', size = 0.2, alpha = 0.8)  +
#   geom_density2d(data = pinnipeds_data_mapping_HI, aes(x = long_corr, y = lat_corr, col = Interaction.Type), bins = 4, size = .8) +
#   scale_alpha(range = c(0, 0.1), guide = FALSE) +
#   xlab("") + ylab("") +
#   #facet_wrap(~ Interaction.Type) +
#   scale_x_continuous(limits = c(-127, -120)) + scale_y_continuous(limits = c(42.8, 49.05)) +
#    theme(legend.position = 'top', legend.title = element_blank(),
#     plot.margin = unit(c(0, -5, 0, -5), "mm"),
#     axis.line = element_blank(),
#     axis.ticks = element_blank(),
#     axis.text = element_blank(),
#     strip.text = element_text(size = 10),
#     strip.background = element_blank(),
#     panel.border = element_rect(colour = "black", fill = NA, size = 5)) +
#   scale_color_manual(values = color1)
# 
# figs("HI_overlap", caption = "Strandings (grey points) and kernel density hotspot contour lines showing hotspots of human interaction cases, with fisheries and boat collisions distributed throughout the Salish Sea and at the mouth of the Columbia River, and gunshot wound cluster centered at the mouth of the Columbia River.")

  #######OLD HI PREV FIG
# #strandings per year for denominators
# numberperyear <- pinnipeds_data %>%
#   group_by(Year.of.Observation) %>%
#   dplyr::summarize(yr.cnt = n_distinct(National.Database.Number))
# 
# #HI over time - by species
# allprev_sp <- pinnipeds_data %>%
#   filter(Pinniped.Common.Name != 'Unidentified') %>%
#   group_by(Findings.of.Human.Interaction, Year.of.Observation, Pinniped.Common.Name) %>%
#   dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
#   dcast(Year.of.Observation + Pinniped.Common.Name ~ Findings.of.Human.Interaction, value.var = 'cnt') 
# allprev_sp[is.na(allprev_sp)] <- 0
# allprev_sp <- allprev_sp %>% transform(HI.Prev = Y/(Y+N+CBD)) %>%
#   dplyr::select(Year.of.Observation, Pinniped.Common.Name, HI.Prev) 
# 
# HI_prev_sp_figure <- ggplot(allprev_sp, aes(Year.of.Observation, HI.Prev)) +
#   geom_smooth(aes(Year.of.Observation, HI.Prev,
#                 group = Pinniped.Common.Name, col = Pinniped.Common.Name),
#               method = 'lm', size = 1, se = F) +
#   #geom_line(aes(Year.of.Observation, HI.Prev, group = Pinniped.Common.Name, col = Pinniped.Common.Name), size = 1) + 
#   geom_smooth(method = 'lm', se = F, col = 'black', linetype = 3) +
#   xlab("") + ylab("Combined HI Proportion") +
#   pubfigure_simple_theme(axis.title = element_text(size = 10),
#                          legend.position = c(.3,.95),
#                          axis.text.x = element_blank()) + 
#   scale_x_continuous(breaks = c(1990, 1995, 2000, 2005, 2010, 2015)) +
#   scale_color_manual(values = color6, guide = guide_legend(nrow = 2))
# 
# #HI prevalence by HI type
# allprev_type <- pinnipeds_data %>%
#   filter(Interaction.Type != 'NA') %>%
#   group_by(Interaction.Type, Year.of.Observation) %>%
#   dplyr::summarize(cnt = n_distinct(National.Database.Number)) %>%
#   dcast(Year.of.Observation ~ Interaction.Type, value.var = 'cnt') 
# allprev_type[is.na(allprev_type)] <- 0
# allprev_type <- allprev_type %>%
#   merge(numberperyear, by = 'Year.of.Observation') %>%
#   transform(Boat = (Boat/yr.cnt), 
#             Fisheries = (Fisheries/yr.cnt),
#             Gunshot = (Gunshot/yr.cnt),
#             Other = (Other/yr.cnt)) %>%
#   dplyr::select(Year.of.Observation, Boat, Gunshot, Fisheries, Other) %>%
#   melt(id.vars = "Year.of.Observation")
# HI_prev_final_old <- plot_grid(HI_prev_sp_figure, HI_type_prev_figure, align = 'v', ncol = 1, labels = "auto", vjust = c(1.2, .1), label_size = 10)
# 
# figs("HI_prev_final_old", caption = "Prevalence of human interaction cases (a) significantly increasing for all combined species (black dotted regression line, y = 0.06x, z = 15.5, *p* < 0.001) and for harbor seals (y = 0.06x, z = 11.4, *p* < 0.001), California sea lions (y = 0.03x, z = 3.8, *p* < 0.001), and northern elephant seals (y = 0.09x, z = 3.5, *p* < 0.001); (b) increasing for all HI types combined (black dotted regression line, y = 0.06x, z = 15.5, *p* < 0.001) and for each HI case type: gunshot wounds (y = 0.039x, z = 6.4, *p* < 0.001), fisheries entanglements (y = 0.043x, z = 5.3, *p* < 0.001), and boat injuries (y = 0.087x, z = 4.2, *p* < 0.001).")


```


```{r density plots two}

# monthly_all_dens_date <- pinnipeds_data %>%
#   transform(Month = as.integer(Month.of.Observation)) %>%
#   transform(Date = as.Date(paste(Year.of.Observation, Month, Day.of.Observation, sep = "-"), format = '%Y-%m-%d')) %>%
#   transform(yday = yday(Date))
# 
# monthly_all_dens_date_sp_2 <- monthly_all_dens_date %>%
#   filter(Pinniped.Common.Name != 'Unidentified') %>%
#   transform(name_grp = ifelse(Pinniped.Common.Name == 'Northern fur seal' |
#                                 Pinniped.Common.Name == 'Northern elephant seal' |
#                                 Pinniped.Common.Name == 'Steller sea lion', 'Other', Pinniped.Common.Name))
# 
# #Species
# monthly_all_sp_dens_2 <-
#   ggplot(data = monthly_all_dens_date_sp_2, aes(yday, col = name_grp)) +
#   geom_line(data = monthly_all_dens_date_sp_2  %>% filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'), stat = 'density', aes(yday, col = name_grp), linetype = 'dashed') +
#   geom_line(data = monthly_all_dens_date_sp_2, stat = 'density') +
#   geom_rug(sides = "b", aes(y = 0), position = 'jitter', alpha = 0.35) +
#   ylab("Relative Frequency Density") + xlab("") +
#   pubfigure_simple_theme(legend.position = c(.22, .9),
#         axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
#         axis.title = element_text(size = 10)) +
#   scale_color_manual(values = color6, guide = guide_legend(nrow = 2)) +
#   scale_y_continuous(limit = c(0, 0.022)) +
#   scale_x_continuous(limit = c(0, 365), breaks = c(0, 30, 60, 90, 120, 150, 180, 210,
#                                                    240, 270, 300, 330),
#                      labels = c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
#                                 'Sep', 'Oct', 'Nov', 'Dec'))
# 
# monthly_all_dens_date_age_2 <- monthly_all_dens_date %>%
#   filter(Age.Class != 'Unid') %>%
#   transform(age_grp = ifelse(Age.Class == 'Subadult' | Age.Class == 'Yearling', 'Subadult', 
#                              ifelse(Age.Class == 'Adult', 'Adult', 'Pup')))
# #Age all
# monthly_all_age_dens_2 <-
#   ggplot(data = monthly_all_dens_date_age_2, aes(yday, col = age_grp)) +
#   geom_line(data = monthly_all_dens_date_age_2  %>% filter(Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'), stat = 'density', aes(yday, col = age_grp), linetype = 'dashed') +
#   geom_line(data = monthly_all_dens_date_age_2, stat = 'density') +
#   geom_rug(sides = "b", aes(y = 0), position = 'jitter', alpha = 0.35) +
#   ylab("Relative Frequency Density") + xlab("") +
#   pubfigure_simple_theme(legend.position = c(.23, .93),
#         axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
#         axis.title = element_text(size = 10)) +
#   scale_color_manual(values = color4_age, guide = guide_legend(nrow = 1)) +
#   scale_y_continuous(limit = c(0, 0.01)) +
#   scale_x_continuous(limit = c(0, 365), breaks = c(0, 30, 60, 90, 120, 150, 180, 210,
#                                                    240, 270, 300, 330),
#                      labels = c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
#                                 'Sep', 'Oct', 'Nov', 'Dec'))
# 
# #HI type
# monthly_HI_type_dens_2 <-
#   ggplot(monthly_all_dens_date %>% filter(Interaction.Type != 'NA'
#                                            & Findings.of.Human.Interaction == 'Y'), aes(yday, col = Interaction.Type)) +
#   #geom_density(col = NA, alpha = .35) +
#   geom_line(stat = 'density', linetype = 'dashed') +
#   #stat_density(geom = "line", position = "identity") +
#   geom_rug(sides = "b", aes(y = 0), position = 'jitter', alpha = 0.35) +
#   ylab("Relative Frequency Density") + xlab("") +
#   pubfigure_simple_theme(legend.position = c(.23, .93),
#         axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
#         axis.title = element_text(size = 10)) +
#   scale_color_manual(values = color4_HI, guide = guide_legend(nrow = 1)) +
#   scale_y_continuous(limit = c(0, 0.008)) +
#   scale_x_continuous(limit = c(0, 365), breaks = c(0, 30, 60, 90, 120, 150, 180, 210,
#                                                    240, 270, 300, 330),
#                      labels = c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
#                                 'Sep', 'Oct', 'Nov', 'Dec'))
# 
# #All sex
# monthly_all_sex_dens_2 <-
#   ggplot(data = monthly_all_dens_date %>% filter(Sex != 'Unid'), aes(yday, col = Sex)) +
#   geom_line(data = monthly_all_dens_date  %>% filter(Sex != 'Unid' & Findings.of.Human.Interaction == 'Y' & Interaction.Type != 'NA'), stat = 'density', aes(yday, col = Sex), linetype = 'dashed') +
#   geom_line(data = monthly_all_dens_date %>% filter(Sex != 'Unid'), stat = 'density') +
#   geom_rug(sides = "b", aes(y = 0), position = 'jitter', alpha = 0.35) +
#   #ylab("Density of Seasonal HI Cases") + xlab("") +
#   ylab("Relative Frequency Density") + xlab("") +
#   pubfigure_simple_theme(legend.position = c(.2, .9),
#         axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5, color = "black", size = 9),
#         axis.title = element_text(size = 10)) +
#   scale_color_manual(values = color2, guide = guide_legend(nrow = 1)) +
#   scale_y_continuous(limit = c(0, 0.008)) +
#   scale_x_continuous(limit = c(0, 365), breaks = c(0, 30, 60, 90, 120, 150, 180, 210,
#                                                    240, 270, 300, 330),
#                      labels = c('Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug',
#                                 'Sep', 'Oct', 'Nov', 'Dec'))
# 
# monthly_all_density_2 <- plot_grid(monthly_all_sp_dens_2, monthly_all_age_dens_2, monthly_HI_type_dens_2, align = 'v', ncol = 1, label_size = 10, labels = "auto")


```

